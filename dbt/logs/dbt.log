[0m10:37:13.184285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79bc3b778bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79bc3b9446d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79bc3b68cf90>]}


============================== 10:37:13.215851 | c554b35c-9aec-4922-9f04-823630d44f88 ==============================
[0m10:37:13.215851 [info ] [MainThread]: Running with dbt=1.10.13
[0m10:37:13.218467 [debug] [MainThread]: running dbt with arguments {'empty': 'None', 'introspect': 'True', 'indirect_selection': 'eager', 'use_colors': 'True', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'quiet': 'False', 'target_path': 'None', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'write_json': 'True', 'debug': 'False', 'send_anonymous_usage_stats': 'True', 'no_print': 'None', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'fail_fast': 'False', 'warn_error': 'None', 'log_cache_events': 'False', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt deps', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80'}
[0m10:37:13.356727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c554b35c-9aec-4922-9f04-823630d44f88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79bc3b57a990>]}
[0m10:37:13.369982 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m10:37:13.374320 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m10:37:13.376291 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.42788655, "process_in_blocks": "2976", "process_kernel_time": 0.355261, "process_mem_max_rss": "101428", "process_out_blocks": "40", "process_user_time": 1.784868}
[0m10:37:13.377665 [debug] [MainThread]: Command `dbt deps` succeeded at 10:37:13.377517 after 0.43 seconds
[0m10:37:13.378767 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79bc3b6b0b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79bc3f72b150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79bc3f5512d0>]}
[0m10:37:13.380202 [debug] [MainThread]: Flushing usage events
[0m10:37:14.360124 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:37:16.461944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x740c295f9490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x740c295aa0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x740c295cd050>]}


============================== 10:37:16.467979 | 993b17b1-c74f-4ea5-b7dd-0619e5b86868 ==============================
[0m10:37:16.467979 [info ] [MainThread]: Running with dbt=1.10.13
[0m10:37:16.474081 [debug] [MainThread]: running dbt with arguments {'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'quiet': 'False', 'target_path': 'None', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'warn_error': 'None', 'no_print': 'None', 'write_json': 'True', 'printer_width': '80', 'empty': 'None', 'cache_selected_only': 'False', 'fail_fast': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'introspect': 'True', 'version_check': 'True', 'invocation_command': 'dbt seed --profiles-dir .', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'use_colors': 'True', 'log_format': 'default', 'profiles_dir': '.', 'send_anonymous_usage_stats': 'True'}
[0m10:37:16.827856 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '993b17b1-c74f-4ea5-b7dd-0619e5b86868', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x740c2a1fb150>]}
[0m10:37:16.891382 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '993b17b1-c74f-4ea5-b7dd-0619e5b86868', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x740c27c20c10>]}
[0m10:37:16.894349 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m10:37:16.974169 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m10:37:16.978452 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m10:37:16.980404 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '993b17b1-c74f-4ea5-b7dd-0619e5b86868', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x740c27c33890>]}
[0m10:37:18.206384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '993b17b1-c74f-4ea5-b7dd-0619e5b86868', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x740c2bc7a3d0>]}
[0m10:37:18.296794 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m10:37:18.306818 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m10:37:18.341753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '993b17b1-c74f-4ea5-b7dd-0619e5b86868', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x740c27883ad0>]}
[0m10:37:18.344865 [info ] [MainThread]: Found 2 models, 1 seed, 447 macros
[0m10:37:18.349461 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '993b17b1-c74f-4ea5-b7dd-0619e5b86868', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x740c27b51e10>]}
[0m10:37:18.354127 [info ] [MainThread]: 
[0m10:37:18.358271 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:37:18.360285 [info ] [MainThread]: 
[0m10:37:18.362213 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:37:18.365188 [debug] [ThreadPool]: Acquiring new postgres connection 'list_ecommerce'
[0m10:37:18.404525 [debug] [ThreadPool]: Using postgres connection "list_ecommerce"
[0m10:37:18.406864 [debug] [ThreadPool]: On list_ecommerce: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "ecommerce_profile", "target_name": "dev", "connection_name": "list_ecommerce"} */

    select distinct nspname from pg_namespace
  
[0m10:37:18.408704 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:37:18.418605 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.010 seconds
[0m10:37:18.421591 [debug] [ThreadPool]: On list_ecommerce: Close
[0m10:37:18.423901 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ecommerce, now create_ecommerce_analytics)
[0m10:37:18.425482 [debug] [ThreadPool]: Creating schema "database: "ecommerce"
schema: "analytics"
"
[0m10:37:18.431552 [debug] [ThreadPool]: Using postgres connection "create_ecommerce_analytics"
[0m10:37:18.433117 [debug] [ThreadPool]: On create_ecommerce_analytics: BEGIN
[0m10:37:18.434590 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:37:18.441138 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m10:37:18.443093 [debug] [ThreadPool]: Using postgres connection "create_ecommerce_analytics"
[0m10:37:18.445972 [debug] [ThreadPool]: On create_ecommerce_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "ecommerce_profile", "target_name": "dev", "connection_name": "create_ecommerce_analytics"} */
create schema if not exists "analytics"
[0m10:37:18.450650 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.001 seconds
[0m10:37:18.455993 [debug] [ThreadPool]: On create_ecommerce_analytics: COMMIT
[0m10:37:18.465516 [debug] [ThreadPool]: Using postgres connection "create_ecommerce_analytics"
[0m10:37:18.475517 [debug] [ThreadPool]: On create_ecommerce_analytics: COMMIT
[0m10:37:18.481191 [debug] [ThreadPool]: SQL status: COMMIT in 0.004 seconds
[0m10:37:18.485245 [debug] [ThreadPool]: On create_ecommerce_analytics: Close
[0m10:37:18.493872 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_ecommerce_analytics, now list_ecommerce_analytics)
[0m10:37:18.502957 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_analytics"
[0m10:37:18.504707 [debug] [ThreadPool]: On list_ecommerce_analytics: BEGIN
[0m10:37:18.506095 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:37:18.513249 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m10:37:18.518397 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_analytics"
[0m10:37:18.520277 [debug] [ThreadPool]: On list_ecommerce_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "ecommerce_profile", "target_name": "dev", "connection_name": "list_ecommerce_analytics"} */
select
      'ecommerce' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'ecommerce' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'ecommerce' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m10:37:18.525293 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.003 seconds
[0m10:37:18.527893 [debug] [ThreadPool]: On list_ecommerce_analytics: ROLLBACK
[0m10:37:18.529987 [debug] [ThreadPool]: On list_ecommerce_analytics: Close
[0m10:37:18.538005 [debug] [MainThread]: Using postgres connection "master"
[0m10:37:18.541211 [debug] [MainThread]: On master: BEGIN
[0m10:37:18.583522 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:37:18.599571 [debug] [MainThread]: SQL status: BEGIN in 0.016 seconds
[0m10:37:18.601565 [debug] [MainThread]: Using postgres connection "master"
[0m10:37:18.603456 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "ecommerce_profile", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m10:37:18.609984 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m10:37:18.613700 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '993b17b1-c74f-4ea5-b7dd-0619e5b86868', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x740c2a4b3110>]}
[0m10:37:18.616194 [debug] [MainThread]: On master: ROLLBACK
[0m10:37:18.619070 [debug] [MainThread]: Using postgres connection "master"
[0m10:37:18.621163 [debug] [MainThread]: On master: BEGIN
[0m10:37:18.623736 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m10:37:18.625452 [debug] [MainThread]: On master: COMMIT
[0m10:37:18.627056 [debug] [MainThread]: Using postgres connection "master"
[0m10:37:18.629675 [debug] [MainThread]: On master: COMMIT
[0m10:37:18.632561 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:37:18.634293 [debug] [MainThread]: On master: Close
[0m10:37:18.642382 [debug] [Thread-1 (]: Began running node seed.ecommerce_dbt.sales_seed
[0m10:37:18.644239 [info ] [Thread-1 (]: 1 of 1 START seed file analytics.sales_seed .................................... [RUN]
[0m10:37:18.647039 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ecommerce_analytics, now seed.ecommerce_dbt.sales_seed)
[0m10:37:18.649830 [debug] [Thread-1 (]: Began compiling node seed.ecommerce_dbt.sales_seed
[0m10:37:18.651700 [debug] [Thread-1 (]: Began executing node seed.ecommerce_dbt.sales_seed
[0m10:37:18.686464 [debug] [Thread-1 (]: Using postgres connection "seed.ecommerce_dbt.sales_seed"
[0m10:37:18.688527 [debug] [Thread-1 (]: On seed.ecommerce_dbt.sales_seed: BEGIN
[0m10:37:18.691241 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:37:18.703345 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m10:37:18.705484 [debug] [Thread-1 (]: Using postgres connection "seed.ecommerce_dbt.sales_seed"
[0m10:37:18.707634 [debug] [Thread-1 (]: On seed.ecommerce_dbt.sales_seed: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "ecommerce_profile", "target_name": "dev", "node_id": "seed.ecommerce_dbt.sales_seed"} */

    create table "ecommerce"."analytics"."sales_seed" ("order_id" text,"order_date" date,"customer_id" text,"product_id" text,"quantity" integer,"price" float8)
  
[0m10:37:18.716955 [debug] [Thread-1 (]: SQL status: CREATE TABLE in 0.007 seconds
[0m10:37:18.736343 [debug] [Thread-1 (]: Using postgres connection "seed.ecommerce_dbt.sales_seed"
[0m10:37:18.738460 [debug] [Thread-1 (]: On seed.ecommerce_dbt.sales_seed: 
          insert into "ecommerce"."analytics"."sales_seed" ("order_id", "order_date", "customer_id", "product_id", "quantity", "price") values
          (%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s)
      ...
[0m10:37:18.742083 [debug] [Thread-1 (]: SQL status: INSERT 0 5 in 0.001 seconds
[0m10:37:18.749154 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.ecommerce_dbt.sales_seed"
[0m10:37:18.784417 [debug] [Thread-1 (]: On seed.ecommerce_dbt.sales_seed: COMMIT
[0m10:37:18.787818 [debug] [Thread-1 (]: Using postgres connection "seed.ecommerce_dbt.sales_seed"
[0m10:37:18.789826 [debug] [Thread-1 (]: On seed.ecommerce_dbt.sales_seed: COMMIT
[0m10:37:18.793122 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m10:37:18.796592 [debug] [Thread-1 (]: On seed.ecommerce_dbt.sales_seed: Close
[0m10:37:18.799989 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '993b17b1-c74f-4ea5-b7dd-0619e5b86868', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x740c27d9a110>]}
[0m10:37:18.801555 [info ] [Thread-1 (]: 1 of 1 OK loaded seed file analytics.sales_seed ................................ [[32mINSERT 5[0m in 0.15s]
[0m10:37:18.803336 [debug] [Thread-1 (]: Finished running node seed.ecommerce_dbt.sales_seed
[0m10:37:18.806023 [debug] [MainThread]: Using postgres connection "master"
[0m10:37:18.807423 [debug] [MainThread]: On master: BEGIN
[0m10:37:18.808694 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:37:18.816148 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m10:37:18.818007 [debug] [MainThread]: On master: COMMIT
[0m10:37:18.820722 [debug] [MainThread]: Using postgres connection "master"
[0m10:37:18.823240 [debug] [MainThread]: On master: COMMIT
[0m10:37:18.824952 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:37:18.826433 [debug] [MainThread]: On master: Close
[0m10:37:18.828030 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:37:18.829367 [debug] [MainThread]: Connection 'seed.ecommerce_dbt.sales_seed' was properly closed.
[0m10:37:18.831036 [info ] [MainThread]: 
[0m10:37:18.832676 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 0.47 seconds (0.47s).
[0m10:37:18.834460 [debug] [MainThread]: Command end result
[0m10:37:18.875230 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m10:37:18.886304 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m10:37:18.903327 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt/target/run_results.json
[0m10:37:18.904962 [info ] [MainThread]: 
[0m10:37:18.906904 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:37:18.908554 [info ] [MainThread]: 
[0m10:37:18.910005 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m10:37:18.912593 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 2.5314372, "process_in_blocks": "1120", "process_kernel_time": 0.280236, "process_mem_max_rss": "122360", "process_out_blocks": "0", "process_user_time": 3.346351}
[0m10:37:18.919443 [debug] [MainThread]: Command `dbt seed` succeeded at 10:37:18.919201 after 2.54 seconds
[0m10:37:18.921640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x740c297939d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x740c2d515010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x740c2a20aad0>]}
[0m10:37:18.924569 [debug] [MainThread]: Flushing usage events
[0m10:37:19.859362 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:37:22.101261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a8299ca2990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a8299ca2b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a8299ca2250>]}


============================== 10:37:22.108397 | 8cd19920-f4b4-47e4-8a38-90a7e5b14caf ==============================
[0m10:37:22.108397 [info ] [MainThread]: Running with dbt=1.10.13
[0m10:37:22.110369 [debug] [MainThread]: running dbt with arguments {'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir .', 'profiles_dir': '.', 'printer_width': '80', 'static_parser': 'True', 'log_path': '/opt/airflow/dbt/logs', 'cache_selected_only': 'False', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'debug': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'quiet': 'False', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'use_colors': 'True', 'no_print': 'None', 'log_format': 'default', 'version_check': 'True', 'warn_error': 'None', 'empty': 'False', 'target_path': 'None'}
[0m10:37:22.330408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8cd19920-f4b4-47e4-8a38-90a7e5b14caf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a82983fd610>]}
[0m10:37:22.439389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8cd19920-f4b4-47e4-8a38-90a7e5b14caf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a829c776a90>]}
[0m10:37:22.442101 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m10:37:22.539438 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m10:37:22.909863 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:37:22.911440 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:37:22.944796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8cd19920-f4b4-47e4-8a38-90a7e5b14caf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a82980a9310>]}
[0m10:37:23.056648 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m10:37:23.067094 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m10:37:23.096766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8cd19920-f4b4-47e4-8a38-90a7e5b14caf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a8298002fd0>]}
[0m10:37:23.099691 [info ] [MainThread]: Found 2 models, 1 seed, 447 macros
[0m10:37:23.103637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8cd19920-f4b4-47e4-8a38-90a7e5b14caf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a82984589d0>]}
[0m10:37:23.106931 [info ] [MainThread]: 
[0m10:37:23.109256 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:37:23.111219 [info ] [MainThread]: 
[0m10:37:23.114635 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:37:23.120541 [debug] [ThreadPool]: Acquiring new postgres connection 'list_ecommerce'
[0m10:37:23.149392 [debug] [ThreadPool]: Using postgres connection "list_ecommerce"
[0m10:37:23.151134 [debug] [ThreadPool]: On list_ecommerce: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "ecommerce_profile", "target_name": "dev", "connection_name": "list_ecommerce"} */

    select distinct nspname from pg_namespace
  
[0m10:37:23.152939 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:37:23.163435 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.010 seconds
[0m10:37:23.165811 [debug] [ThreadPool]: On list_ecommerce: Close
[0m10:37:23.169068 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ecommerce, now list_ecommerce_analytics)
[0m10:37:23.175027 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_analytics"
[0m10:37:23.176678 [debug] [ThreadPool]: On list_ecommerce_analytics: BEGIN
[0m10:37:23.177782 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:37:23.187009 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m10:37:23.188772 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_analytics"
[0m10:37:23.193938 [debug] [ThreadPool]: On list_ecommerce_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "ecommerce_profile", "target_name": "dev", "connection_name": "list_ecommerce_analytics"} */
select
      'ecommerce' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'ecommerce' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'ecommerce' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m10:37:23.201464 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.005 seconds
[0m10:37:23.205441 [debug] [ThreadPool]: On list_ecommerce_analytics: ROLLBACK
[0m10:37:23.206996 [debug] [ThreadPool]: On list_ecommerce_analytics: Close
[0m10:37:23.214195 [debug] [MainThread]: Using postgres connection "master"
[0m10:37:23.216559 [debug] [MainThread]: On master: BEGIN
[0m10:37:23.217935 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:37:23.225653 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m10:37:23.228648 [debug] [MainThread]: Using postgres connection "master"
[0m10:37:23.230403 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "ecommerce_profile", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m10:37:23.236037 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m10:37:23.238186 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8cd19920-f4b4-47e4-8a38-90a7e5b14caf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a8297649410>]}
[0m10:37:23.240137 [debug] [MainThread]: On master: ROLLBACK
[0m10:37:23.241789 [debug] [MainThread]: Using postgres connection "master"
[0m10:37:23.243008 [debug] [MainThread]: On master: BEGIN
[0m10:37:23.245560 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m10:37:23.249152 [debug] [MainThread]: On master: COMMIT
[0m10:37:23.250691 [debug] [MainThread]: Using postgres connection "master"
[0m10:37:23.252658 [debug] [MainThread]: On master: COMMIT
[0m10:37:23.254750 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:37:23.256410 [debug] [MainThread]: On master: Close
[0m10:37:23.262229 [debug] [Thread-1 (]: Began running node model.ecommerce_dbt.stg_sales
[0m10:37:23.265393 [info ] [Thread-1 (]: 1 of 2 START sql view model analytics.stg_sales ................................ [RUN]
[0m10:37:23.267995 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ecommerce_analytics, now model.ecommerce_dbt.stg_sales)
[0m10:37:23.269983 [debug] [Thread-1 (]: Began compiling node model.ecommerce_dbt.stg_sales
[0m10:37:23.278201 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_dbt.stg_sales"
[0m10:37:23.317100 [debug] [Thread-1 (]: Began executing node model.ecommerce_dbt.stg_sales
[0m10:37:23.354352 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_dbt.stg_sales"
[0m10:37:23.386932 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_dbt.stg_sales"
[0m10:37:23.388513 [debug] [Thread-1 (]: On model.ecommerce_dbt.stg_sales: BEGIN
[0m10:37:23.390260 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:37:23.400856 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m10:37:23.436269 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_dbt.stg_sales"
[0m10:37:23.447314 [debug] [Thread-1 (]: On model.ecommerce_dbt.stg_sales: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "ecommerce_profile", "target_name": "dev", "node_id": "model.ecommerce_dbt.stg_sales"} */

  create view "ecommerce"."analytics"."stg_sales__dbt_tmp"
    
    
  as (
    with raw as (
  select
    order_id,
    order_date::date as order_date,
    customer_id,
    product_id,
    quantity,
    price
  from raw.sales
)

select * from raw
  );
[0m10:37:23.456437 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m10:37:23.470243 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_dbt.stg_sales"
[0m10:37:23.475132 [debug] [Thread-1 (]: On model.ecommerce_dbt.stg_sales: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "ecommerce_profile", "target_name": "dev", "node_id": "model.ecommerce_dbt.stg_sales"} */
alter table "ecommerce"."analytics"."stg_sales__dbt_tmp" rename to "stg_sales"
[0m10:37:23.484472 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m10:37:23.501579 [debug] [Thread-1 (]: On model.ecommerce_dbt.stg_sales: COMMIT
[0m10:37:23.503823 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_dbt.stg_sales"
[0m10:37:23.505422 [debug] [Thread-1 (]: On model.ecommerce_dbt.stg_sales: COMMIT
[0m10:37:23.511542 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m10:37:23.520369 [debug] [Thread-1 (]: Applying DROP to: "ecommerce"."analytics"."stg_sales__dbt_backup"
[0m10:37:23.530906 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_dbt.stg_sales"
[0m10:37:23.534480 [debug] [Thread-1 (]: On model.ecommerce_dbt.stg_sales: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "ecommerce_profile", "target_name": "dev", "node_id": "model.ecommerce_dbt.stg_sales"} */
drop view if exists "ecommerce"."analytics"."stg_sales__dbt_backup" cascade
[0m10:37:23.538500 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m10:37:23.542681 [debug] [Thread-1 (]: On model.ecommerce_dbt.stg_sales: Close
[0m10:37:23.547167 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8cd19920-f4b4-47e4-8a38-90a7e5b14caf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a82974c6790>]}
[0m10:37:23.549628 [info ] [Thread-1 (]: 1 of 2 OK created sql view model analytics.stg_sales ........................... [[32mCREATE VIEW[0m in 0.28s]
[0m10:37:23.552594 [debug] [Thread-1 (]: Finished running node model.ecommerce_dbt.stg_sales
[0m10:37:23.555800 [debug] [Thread-1 (]: Began running node model.ecommerce_dbt.mart_sales_summary
[0m10:37:23.558461 [info ] [Thread-1 (]: 2 of 2 START sql view model analytics.mart_sales_summary ....................... [RUN]
[0m10:37:23.560999 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ecommerce_dbt.stg_sales, now model.ecommerce_dbt.mart_sales_summary)
[0m10:37:23.563777 [debug] [Thread-1 (]: Began compiling node model.ecommerce_dbt.mart_sales_summary
[0m10:37:23.568772 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_dbt.mart_sales_summary"
[0m10:37:23.595623 [debug] [Thread-1 (]: Began executing node model.ecommerce_dbt.mart_sales_summary
[0m10:37:23.604881 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_dbt.mart_sales_summary"
[0m10:37:23.635502 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_dbt.mart_sales_summary"
[0m10:37:23.637533 [debug] [Thread-1 (]: On model.ecommerce_dbt.mart_sales_summary: BEGIN
[0m10:37:23.639522 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:37:23.648591 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m10:37:23.651763 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_dbt.mart_sales_summary"
[0m10:37:23.654960 [debug] [Thread-1 (]: On model.ecommerce_dbt.mart_sales_summary: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "ecommerce_profile", "target_name": "dev", "node_id": "model.ecommerce_dbt.mart_sales_summary"} */

  create view "ecommerce"."analytics"."mart_sales_summary__dbt_tmp"
    
    
  as (
    with sales as (
  select order_date, quantity, price, quantity * price as sales_amount
  from "ecommerce"."analytics"."stg_sales"
)
select
  order_date,
  sum(quantity) as total_items,
  sum(sales_amount) as total_revenue
from sales
group by order_date
order by order_date
  );
[0m10:37:23.659600 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m10:37:23.666094 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_dbt.mart_sales_summary"
[0m10:37:23.668008 [debug] [Thread-1 (]: On model.ecommerce_dbt.mart_sales_summary: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "ecommerce_profile", "target_name": "dev", "node_id": "model.ecommerce_dbt.mart_sales_summary"} */
alter table "ecommerce"."analytics"."mart_sales_summary__dbt_tmp" rename to "mart_sales_summary"
[0m10:37:23.670824 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:37:23.673876 [debug] [Thread-1 (]: On model.ecommerce_dbt.mart_sales_summary: COMMIT
[0m10:37:23.675672 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_dbt.mart_sales_summary"
[0m10:37:23.677572 [debug] [Thread-1 (]: On model.ecommerce_dbt.mart_sales_summary: COMMIT
[0m10:37:23.683699 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m10:37:23.688848 [debug] [Thread-1 (]: Applying DROP to: "ecommerce"."analytics"."mart_sales_summary__dbt_backup"
[0m10:37:23.691739 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_dbt.mart_sales_summary"
[0m10:37:23.693542 [debug] [Thread-1 (]: On model.ecommerce_dbt.mart_sales_summary: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "ecommerce_profile", "target_name": "dev", "node_id": "model.ecommerce_dbt.mart_sales_summary"} */
drop view if exists "ecommerce"."analytics"."mart_sales_summary__dbt_backup" cascade
[0m10:37:23.696733 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m10:37:23.700674 [debug] [Thread-1 (]: On model.ecommerce_dbt.mart_sales_summary: Close
[0m10:37:23.703289 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8cd19920-f4b4-47e4-8a38-90a7e5b14caf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a8297548410>]}
[0m10:37:23.706062 [info ] [Thread-1 (]: 2 of 2 OK created sql view model analytics.mart_sales_summary .................. [[32mCREATE VIEW[0m in 0.14s]
[0m10:37:23.708300 [debug] [Thread-1 (]: Finished running node model.ecommerce_dbt.mart_sales_summary
[0m10:37:23.712026 [debug] [MainThread]: Using postgres connection "master"
[0m10:37:23.715020 [debug] [MainThread]: On master: BEGIN
[0m10:37:23.716840 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:37:23.725776 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m10:37:23.727803 [debug] [MainThread]: On master: COMMIT
[0m10:37:23.731652 [debug] [MainThread]: Using postgres connection "master"
[0m10:37:23.733677 [debug] [MainThread]: On master: COMMIT
[0m10:37:23.736063 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:37:23.737575 [debug] [MainThread]: On master: Close
[0m10:37:23.739741 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:37:23.741860 [debug] [MainThread]: Connection 'model.ecommerce_dbt.mart_sales_summary' was properly closed.
[0m10:37:23.743805 [info ] [MainThread]: 
[0m10:37:23.745295 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 0.63 seconds (0.63s).
[0m10:37:23.748962 [debug] [MainThread]: Command end result
[0m10:37:23.800618 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m10:37:23.809767 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m10:37:23.826740 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt/target/run_results.json
[0m10:37:23.829091 [info ] [MainThread]: 
[0m10:37:23.831674 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:37:23.833577 [info ] [MainThread]: 
[0m10:37:23.835348 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m10:37:23.838335 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.814316, "process_in_blocks": "0", "process_kernel_time": 0.413286, "process_mem_max_rss": "118892", "process_out_blocks": "0", "process_user_time": 2.545189}
[0m10:37:23.841291 [debug] [MainThread]: Command `dbt run` succeeded at 10:37:23.840925 after 1.82 seconds
[0m10:37:23.843890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a829db891d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a829dc0f990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a829dc0c190>]}
[0m10:37:23.846354 [debug] [MainThread]: Flushing usage events
[0m10:37:24.773551 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:37:27.090042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x712cd8441290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x712cd8611e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x712cd85ee950>]}


============================== 10:37:27.096468 | 6647d00f-07e0-4cb4-8ce7-de473fc2528c ==============================
[0m10:37:27.096468 [info ] [MainThread]: Running with dbt=1.10.13
[0m10:37:27.098192 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'use_experimental_parser': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'empty': 'None', 'warn_error': 'None', 'partial_parse': 'True', 'indirect_selection': 'eager', 'static_parser': 'True', 'target_path': 'None', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'printer_width': '80', 'fail_fast': 'False', 'log_format': 'default', 'cache_selected_only': 'False', 'quiet': 'False', 'write_json': 'True', 'log_cache_events': 'False', 'profiles_dir': '.', 'use_colors': 'True', 'no_print': 'None', 'send_anonymous_usage_stats': 'True', 'invocation_command': 'dbt test --profiles-dir .'}
[0m10:37:27.356336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6647d00f-07e0-4cb4-8ce7-de473fc2528c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x712cd8777710>]}
[0m10:37:27.471151 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6647d00f-07e0-4cb4-8ce7-de473fc2528c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x712cdb146110>]}
[0m10:37:27.473843 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m10:37:27.553639 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m10:37:27.744628 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:37:27.747697 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:37:27.775363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6647d00f-07e0-4cb4-8ce7-de473fc2528c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x712cd69fa110>]}
[0m10:37:27.840226 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m10:37:27.865371 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m10:37:27.907951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6647d00f-07e0-4cb4-8ce7-de473fc2528c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x712cd68a8990>]}
[0m10:37:27.910367 [info ] [MainThread]: Found 2 models, 1 seed, 447 macros
[0m10:37:27.912638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6647d00f-07e0-4cb4-8ce7-de473fc2528c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x712cd68d6c90>]}
[0m10:37:27.916504 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m10:37:27.921313 [debug] [MainThread]: Command end result
[0m10:37:27.963771 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m10:37:27.969915 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m10:37:27.982934 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt/target/run_results.json
[0m10:37:27.984926 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.9874076, "process_in_blocks": "0", "process_kernel_time": 0.325658, "process_mem_max_rss": "113476", "process_out_blocks": "0", "process_user_time": 2.29167}
[0m10:37:27.988091 [debug] [MainThread]: Command `dbt test` succeeded at 10:37:27.987906 after 0.99 seconds
[0m10:37:27.990756 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x712cd845ed10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x712cd845ef90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x712cdc5591d0>]}
[0m10:37:27.993986 [debug] [MainThread]: Flushing usage events
[0m10:37:28.932868 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:51:07.387401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x718e11f49550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x718e11ef80d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x718e11ef8950>]}


============================== 10:51:07.403411 | 9198a806-b4f1-4d26-ba7a-2220fec3e675 ==============================
[0m10:51:07.403411 [info ] [MainThread]: Running with dbt=1.10.13
[0m10:51:07.405838 [debug] [MainThread]: running dbt with arguments {'empty': 'None', 'write_json': 'True', 'log_cache_events': 'False', 'warn_error': 'None', 'send_anonymous_usage_stats': 'True', 'log_format': 'default', 'printer_width': '80', 'cache_selected_only': 'False', 'version_check': 'True', 'indirect_selection': 'eager', 'invocation_command': 'dbt deps', 'fail_fast': 'False', 'debug': 'False', 'use_experimental_parser': 'False', 'log_path': '/opt/airflow/dbt/logs', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'no_print': 'None', 'profiles_dir': '/opt/airflow/dbt', 'use_colors': 'True', 'partial_parse': 'True', 'quiet': 'False', 'static_parser': 'True'}
[0m10:51:07.633516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9198a806-b4f1-4d26-ba7a-2220fec3e675', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x718e11e31290>]}
[0m10:51:07.658962 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m10:51:07.674468 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m10:51:07.680501 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.36641952, "process_in_blocks": "28664", "process_kernel_time": 0.377133, "process_mem_max_rss": "101232", "process_out_blocks": "0", "process_user_time": 1.659386}
[0m10:51:07.687729 [debug] [MainThread]: Command `dbt deps` succeeded at 10:51:07.687409 after 0.37 seconds
[0m10:51:07.690142 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x718e11ef8750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x718e11ef8d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x718e15e78210>]}
[0m10:51:07.692159 [debug] [MainThread]: Flushing usage events
[0m10:51:08.742132 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:51:10.866377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7214c7737610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7214c7735850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7214c77185d0>]}


============================== 10:51:10.871315 | e1b3a53a-f05e-4c8d-9138-2a0339fcbc77 ==============================
[0m10:51:10.871315 [info ] [MainThread]: Running with dbt=1.10.13
[0m10:51:10.873985 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'empty': 'None', 'cache_selected_only': 'False', 'fail_fast': 'False', 'log_cache_events': 'False', 'version_check': 'True', 'debug': 'False', 'warn_error': 'None', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'profiles_dir': '.', 'write_json': 'True', 'printer_width': '80', 'use_colors': 'True', 'log_format': 'default', 'indirect_selection': 'eager', 'target_path': 'None', 'introspect': 'True', 'quiet': 'False', 'log_path': '/opt/airflow/dbt/logs', 'invocation_command': 'dbt seed --profiles-dir .', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_experimental_parser': 'False'}
[0m10:51:11.051859 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e1b3a53a-f05e-4c8d-9138-2a0339fcbc77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7214c5d03bd0>]}
[0m10:51:11.096510 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e1b3a53a-f05e-4c8d-9138-2a0339fcbc77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7214ca2321d0>]}
[0m10:51:11.121163 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m10:51:11.212813 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m10:51:11.452830 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:51:11.454871 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:51:11.489944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e1b3a53a-f05e-4c8d-9138-2a0339fcbc77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7214c5b84510>]}
[0m10:51:11.599142 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m10:51:11.633735 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m10:51:11.676411 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e1b3a53a-f05e-4c8d-9138-2a0339fcbc77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7214c5a2b950>]}
[0m10:51:11.681701 [info ] [MainThread]: Found 2 models, 1 seed, 447 macros
[0m10:51:11.686074 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e1b3a53a-f05e-4c8d-9138-2a0339fcbc77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7214c5e78b90>]}
[0m10:51:11.691744 [info ] [MainThread]: 
[0m10:51:11.695534 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:51:11.697749 [info ] [MainThread]: 
[0m10:51:11.700025 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:51:11.703641 [debug] [ThreadPool]: Acquiring new postgres connection 'list_ecommerce'
[0m10:51:11.742912 [debug] [ThreadPool]: Using postgres connection "list_ecommerce"
[0m10:51:11.746364 [debug] [ThreadPool]: On list_ecommerce: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "ecommerce_profile", "target_name": "dev", "connection_name": "list_ecommerce"} */

    select distinct nspname from pg_namespace
  
[0m10:51:11.748385 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:51:11.758194 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.010 seconds
[0m10:51:11.762415 [debug] [ThreadPool]: On list_ecommerce: Close
[0m10:51:11.770057 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ecommerce, now list_ecommerce_analytics)
[0m10:51:11.776661 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_analytics"
[0m10:51:11.780025 [debug] [ThreadPool]: On list_ecommerce_analytics: BEGIN
[0m10:51:11.781747 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:51:11.790132 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m10:51:11.792323 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_analytics"
[0m10:51:11.798794 [debug] [ThreadPool]: On list_ecommerce_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "ecommerce_profile", "target_name": "dev", "connection_name": "list_ecommerce_analytics"} */
select
      'ecommerce' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'ecommerce' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'ecommerce' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m10:51:11.806784 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.006 seconds
[0m10:51:11.809306 [debug] [ThreadPool]: On list_ecommerce_analytics: ROLLBACK
[0m10:51:11.811404 [debug] [ThreadPool]: On list_ecommerce_analytics: Close
[0m10:51:11.817716 [debug] [MainThread]: Using postgres connection "master"
[0m10:51:11.819052 [debug] [MainThread]: On master: BEGIN
[0m10:51:11.820376 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:51:11.827859 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m10:51:11.830387 [debug] [MainThread]: Using postgres connection "master"
[0m10:51:11.832291 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "ecommerce_profile", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m10:51:11.840809 [debug] [MainThread]: SQL status: SELECT 2 in 0.007 seconds
[0m10:51:11.843469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e1b3a53a-f05e-4c8d-9138-2a0339fcbc77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7214c5b3f150>]}
[0m10:51:11.846334 [debug] [MainThread]: On master: ROLLBACK
[0m10:51:11.848285 [debug] [MainThread]: Using postgres connection "master"
[0m10:51:11.849729 [debug] [MainThread]: On master: BEGIN
[0m10:51:11.851823 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m10:51:11.854128 [debug] [MainThread]: On master: COMMIT
[0m10:51:11.855596 [debug] [MainThread]: Using postgres connection "master"
[0m10:51:11.856789 [debug] [MainThread]: On master: COMMIT
[0m10:51:11.858305 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:51:11.859746 [debug] [MainThread]: On master: Close
[0m10:51:11.868246 [debug] [Thread-1 (]: Began running node seed.ecommerce_dbt.sales_seed
[0m10:51:11.869702 [info ] [Thread-1 (]: 1 of 1 START seed file analytics.sales_seed .................................... [RUN]
[0m10:51:11.871341 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ecommerce_analytics, now seed.ecommerce_dbt.sales_seed)
[0m10:51:11.872858 [debug] [Thread-1 (]: Began compiling node seed.ecommerce_dbt.sales_seed
[0m10:51:11.874688 [debug] [Thread-1 (]: Began executing node seed.ecommerce_dbt.sales_seed
[0m10:51:11.911062 [debug] [Thread-1 (]: Using postgres connection "seed.ecommerce_dbt.sales_seed"
[0m10:51:11.913407 [debug] [Thread-1 (]: On seed.ecommerce_dbt.sales_seed: BEGIN
[0m10:51:11.915354 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:51:11.923756 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m10:51:11.925566 [debug] [Thread-1 (]: Using postgres connection "seed.ecommerce_dbt.sales_seed"
[0m10:51:11.927856 [debug] [Thread-1 (]: On seed.ecommerce_dbt.sales_seed: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "ecommerce_profile", "target_name": "dev", "node_id": "seed.ecommerce_dbt.sales_seed"} */
truncate table "ecommerce"."analytics"."sales_seed"
[0m10:51:11.935156 [debug] [Thread-1 (]: SQL status: TRUNCATE TABLE in 0.004 seconds
[0m10:51:11.951928 [debug] [Thread-1 (]: Using postgres connection "seed.ecommerce_dbt.sales_seed"
[0m10:51:11.953602 [debug] [Thread-1 (]: On seed.ecommerce_dbt.sales_seed: 
          insert into "ecommerce"."analytics"."sales_seed" ("order_id", "order_date", "customer_id", "product_id", "quantity", "price") values
          (%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s)
      ...
[0m10:51:11.956238 [debug] [Thread-1 (]: SQL status: INSERT 0 5 in 0.001 seconds
[0m10:51:11.963257 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.ecommerce_dbt.sales_seed"
[0m10:51:11.984689 [debug] [Thread-1 (]: On seed.ecommerce_dbt.sales_seed: COMMIT
[0m10:51:11.986853 [debug] [Thread-1 (]: Using postgres connection "seed.ecommerce_dbt.sales_seed"
[0m10:51:11.988648 [debug] [Thread-1 (]: On seed.ecommerce_dbt.sales_seed: COMMIT
[0m10:51:11.992918 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m10:51:11.996563 [debug] [Thread-1 (]: On seed.ecommerce_dbt.sales_seed: Close
[0m10:51:12.000622 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e1b3a53a-f05e-4c8d-9138-2a0339fcbc77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7214c5e5d390>]}
[0m10:51:12.002228 [info ] [Thread-1 (]: 1 of 1 OK loaded seed file analytics.sales_seed ................................ [[32mINSERT 5[0m in 0.13s]
[0m10:51:12.003989 [debug] [Thread-1 (]: Finished running node seed.ecommerce_dbt.sales_seed
[0m10:51:12.006768 [debug] [MainThread]: Using postgres connection "master"
[0m10:51:12.008014 [debug] [MainThread]: On master: BEGIN
[0m10:51:12.009424 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:51:12.017437 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m10:51:12.018988 [debug] [MainThread]: On master: COMMIT
[0m10:51:12.020840 [debug] [MainThread]: Using postgres connection "master"
[0m10:51:12.022130 [debug] [MainThread]: On master: COMMIT
[0m10:51:12.023733 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:51:12.025148 [debug] [MainThread]: On master: Close
[0m10:51:12.027872 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:51:12.030065 [debug] [MainThread]: Connection 'seed.ecommerce_dbt.sales_seed' was properly closed.
[0m10:51:12.031413 [info ] [MainThread]: 
[0m10:51:12.032825 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 0.33 seconds (0.33s).
[0m10:51:12.034862 [debug] [MainThread]: Command end result
[0m10:51:12.106318 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m10:51:12.118250 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m10:51:12.141752 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt/target/run_results.json
[0m10:51:12.145494 [info ] [MainThread]: 
[0m10:51:12.151331 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:51:12.154074 [info ] [MainThread]: 
[0m10:51:12.156725 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m10:51:12.160185 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 1.3437996, "process_in_blocks": "3880", "process_kernel_time": 0.293422, "process_mem_max_rss": "119332", "process_out_blocks": "0", "process_user_time": 2.182069}
[0m10:51:12.163642 [debug] [MainThread]: Command `dbt seed` succeeded at 10:51:12.163413 after 1.35 seconds
[0m10:51:12.166282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7214c78d3a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7214cb833210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7214cb659390>]}
[0m10:51:12.168562 [debug] [MainThread]: Flushing usage events
[0m10:51:13.119765 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:51:15.200208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71097a467290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71097a415250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71097a4665d0>]}


============================== 10:51:15.209672 | eea18d80-8e2a-4296-8204-ab7d5981d985 ==============================
[0m10:51:15.209672 [info ] [MainThread]: Running with dbt=1.10.13
[0m10:51:15.216356 [debug] [MainThread]: running dbt with arguments {'use_colors': 'True', 'empty': 'False', 'invocation_command': 'dbt run --profiles-dir .', 'log_path': '/opt/airflow/dbt/logs', 'printer_width': '80', 'partial_parse': 'True', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'use_experimental_parser': 'False', 'log_format': 'default', 'profiles_dir': '.', 'target_path': 'None', 'version_check': 'True', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'introspect': 'True', 'quiet': 'False', 'write_json': 'True', 'cache_selected_only': 'False', 'log_cache_events': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True'}
[0m10:51:15.485827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'eea18d80-8e2a-4296-8204-ab7d5981d985', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x710978b6b810>]}
[0m10:51:15.567760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'eea18d80-8e2a-4296-8204-ab7d5981d985', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71097cee8d10>]}
[0m10:51:15.570346 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m10:51:15.693647 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m10:51:15.984294 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:51:15.986907 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:51:16.016196 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'eea18d80-8e2a-4296-8204-ab7d5981d985', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x710978a1a550>]}
[0m10:51:16.133690 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m10:51:16.144194 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m10:51:16.173729 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'eea18d80-8e2a-4296-8204-ab7d5981d985', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7109789f2390>]}
[0m10:51:16.181160 [info ] [MainThread]: Found 2 models, 1 seed, 447 macros
[0m10:51:16.184390 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eea18d80-8e2a-4296-8204-ab7d5981d985', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x710978a18a50>]}
[0m10:51:16.187351 [info ] [MainThread]: 
[0m10:51:16.188651 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:51:16.194748 [info ] [MainThread]: 
[0m10:51:16.196946 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:51:16.202602 [debug] [ThreadPool]: Acquiring new postgres connection 'list_ecommerce'
[0m10:51:16.235014 [debug] [ThreadPool]: Using postgres connection "list_ecommerce"
[0m10:51:16.236933 [debug] [ThreadPool]: On list_ecommerce: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "ecommerce_profile", "target_name": "dev", "connection_name": "list_ecommerce"} */

    select distinct nspname from pg_namespace
  
[0m10:51:16.238095 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:51:16.249236 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.011 seconds
[0m10:51:16.251570 [debug] [ThreadPool]: On list_ecommerce: Close
[0m10:51:16.255217 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ecommerce, now list_ecommerce_analytics)
[0m10:51:16.263637 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_analytics"
[0m10:51:16.265228 [debug] [ThreadPool]: On list_ecommerce_analytics: BEGIN
[0m10:51:16.267036 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:51:16.278720 [debug] [ThreadPool]: SQL status: BEGIN in 0.012 seconds
[0m10:51:16.280909 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_analytics"
[0m10:51:16.286641 [debug] [ThreadPool]: On list_ecommerce_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "ecommerce_profile", "target_name": "dev", "connection_name": "list_ecommerce_analytics"} */
select
      'ecommerce' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'ecommerce' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'ecommerce' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m10:51:16.294235 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.005 seconds
[0m10:51:16.298889 [debug] [ThreadPool]: On list_ecommerce_analytics: ROLLBACK
[0m10:51:16.301100 [debug] [ThreadPool]: On list_ecommerce_analytics: Close
[0m10:51:16.311616 [debug] [MainThread]: Using postgres connection "master"
[0m10:51:16.313560 [debug] [MainThread]: On master: BEGIN
[0m10:51:16.315305 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:51:16.327305 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m10:51:16.329499 [debug] [MainThread]: Using postgres connection "master"
[0m10:51:16.331579 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "ecommerce_profile", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m10:51:16.338711 [debug] [MainThread]: SQL status: SELECT 2 in 0.004 seconds
[0m10:51:16.345204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eea18d80-8e2a-4296-8204-ab7d5981d985', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71097864f250>]}
[0m10:51:16.348020 [debug] [MainThread]: On master: ROLLBACK
[0m10:51:16.350562 [debug] [MainThread]: Using postgres connection "master"
[0m10:51:16.352587 [debug] [MainThread]: On master: BEGIN
[0m10:51:16.355684 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m10:51:16.360516 [debug] [MainThread]: On master: COMMIT
[0m10:51:16.363129 [debug] [MainThread]: Using postgres connection "master"
[0m10:51:16.365617 [debug] [MainThread]: On master: COMMIT
[0m10:51:16.368349 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:51:16.369773 [debug] [MainThread]: On master: Close
[0m10:51:16.378360 [debug] [Thread-1 (]: Began running node model.ecommerce_dbt.stg_sales
[0m10:51:16.380688 [info ] [Thread-1 (]: 1 of 2 START sql view model analytics.stg_sales ................................ [RUN]
[0m10:51:16.382741 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ecommerce_analytics, now model.ecommerce_dbt.stg_sales)
[0m10:51:16.384981 [debug] [Thread-1 (]: Began compiling node model.ecommerce_dbt.stg_sales
[0m10:51:16.394531 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_dbt.stg_sales"
[0m10:51:16.412132 [debug] [Thread-1 (]: Began executing node model.ecommerce_dbt.stg_sales
[0m10:51:16.447708 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_dbt.stg_sales"
[0m10:51:16.464718 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_dbt.stg_sales"
[0m10:51:16.466662 [debug] [Thread-1 (]: On model.ecommerce_dbt.stg_sales: BEGIN
[0m10:51:16.468879 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:51:16.479784 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m10:51:16.481454 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_dbt.stg_sales"
[0m10:51:16.483267 [debug] [Thread-1 (]: On model.ecommerce_dbt.stg_sales: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "ecommerce_profile", "target_name": "dev", "node_id": "model.ecommerce_dbt.stg_sales"} */

  create view "ecommerce"."analytics"."stg_sales__dbt_tmp"
    
    
  as (
    with raw as (
  select
    order_id,
    order_date::date as order_date,
    customer_id,
    product_id,
    quantity,
    price
  from raw.sales
)

select * from raw
  );
[0m10:51:16.515058 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.030 seconds
[0m10:51:16.522900 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_dbt.stg_sales"
[0m10:51:16.527488 [debug] [Thread-1 (]: On model.ecommerce_dbt.stg_sales: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "ecommerce_profile", "target_name": "dev", "node_id": "model.ecommerce_dbt.stg_sales"} */
alter table "ecommerce"."analytics"."stg_sales" rename to "stg_sales__dbt_backup"
[0m10:51:16.530883 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:51:16.536962 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_dbt.stg_sales"
[0m10:51:16.538993 [debug] [Thread-1 (]: On model.ecommerce_dbt.stg_sales: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "ecommerce_profile", "target_name": "dev", "node_id": "model.ecommerce_dbt.stg_sales"} */
alter table "ecommerce"."analytics"."stg_sales__dbt_tmp" rename to "stg_sales"
[0m10:51:16.543297 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:51:16.560339 [debug] [Thread-1 (]: On model.ecommerce_dbt.stg_sales: COMMIT
[0m10:51:16.561917 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_dbt.stg_sales"
[0m10:51:16.564021 [debug] [Thread-1 (]: On model.ecommerce_dbt.stg_sales: COMMIT
[0m10:51:16.569098 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m10:51:16.578378 [debug] [Thread-1 (]: Applying DROP to: "ecommerce"."analytics"."stg_sales__dbt_backup"
[0m10:51:16.584446 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_dbt.stg_sales"
[0m10:51:16.585943 [debug] [Thread-1 (]: On model.ecommerce_dbt.stg_sales: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "ecommerce_profile", "target_name": "dev", "node_id": "model.ecommerce_dbt.stg_sales"} */
drop view if exists "ecommerce"."analytics"."stg_sales__dbt_backup" cascade
[0m10:51:16.593404 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.006 seconds
[0m10:51:16.596995 [debug] [Thread-1 (]: On model.ecommerce_dbt.stg_sales: Close
[0m10:51:16.600206 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eea18d80-8e2a-4296-8204-ab7d5981d985', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x710977cc5850>]}
[0m10:51:16.602079 [info ] [Thread-1 (]: 1 of 2 OK created sql view model analytics.stg_sales ........................... [[32mCREATE VIEW[0m in 0.22s]
[0m10:51:16.604634 [debug] [Thread-1 (]: Finished running node model.ecommerce_dbt.stg_sales
[0m10:51:16.607852 [debug] [Thread-1 (]: Began running node model.ecommerce_dbt.mart_sales_summary
[0m10:51:16.610187 [info ] [Thread-1 (]: 2 of 2 START sql view model analytics.mart_sales_summary ....................... [RUN]
[0m10:51:16.612138 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ecommerce_dbt.stg_sales, now model.ecommerce_dbt.mart_sales_summary)
[0m10:51:16.615332 [debug] [Thread-1 (]: Began compiling node model.ecommerce_dbt.mart_sales_summary
[0m10:51:16.619677 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_dbt.mart_sales_summary"
[0m10:51:16.635171 [debug] [Thread-1 (]: Began executing node model.ecommerce_dbt.mart_sales_summary
[0m10:51:16.640284 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_dbt.mart_sales_summary"
[0m10:51:16.655560 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_dbt.mart_sales_summary"
[0m10:51:16.657515 [debug] [Thread-1 (]: On model.ecommerce_dbt.mart_sales_summary: BEGIN
[0m10:51:16.659683 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:51:16.668004 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m10:51:16.669553 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_dbt.mart_sales_summary"
[0m10:51:16.671104 [debug] [Thread-1 (]: On model.ecommerce_dbt.mart_sales_summary: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "ecommerce_profile", "target_name": "dev", "node_id": "model.ecommerce_dbt.mart_sales_summary"} */

  create view "ecommerce"."analytics"."mart_sales_summary__dbt_tmp"
    
    
  as (
    with sales as (
  select order_date, quantity, price, quantity * price as sales_amount
  from "ecommerce"."analytics"."stg_sales"
)
select
  order_date,
  sum(quantity) as total_items,
  sum(sales_amount) as total_revenue
from sales
group by order_date
order by order_date
  );
[0m10:51:16.676793 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m10:51:16.681551 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_dbt.mart_sales_summary"
[0m10:51:16.683314 [debug] [Thread-1 (]: On model.ecommerce_dbt.mart_sales_summary: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "ecommerce_profile", "target_name": "dev", "node_id": "model.ecommerce_dbt.mart_sales_summary"} */
alter table "ecommerce"."analytics"."mart_sales_summary__dbt_tmp" rename to "mart_sales_summary"
[0m10:51:16.686455 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:51:16.689821 [debug] [Thread-1 (]: On model.ecommerce_dbt.mart_sales_summary: COMMIT
[0m10:51:16.691731 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_dbt.mart_sales_summary"
[0m10:51:16.693741 [debug] [Thread-1 (]: On model.ecommerce_dbt.mart_sales_summary: COMMIT
[0m10:51:16.698598 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m10:51:16.702196 [debug] [Thread-1 (]: Applying DROP to: "ecommerce"."analytics"."mart_sales_summary__dbt_backup"
[0m10:51:16.704849 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_dbt.mart_sales_summary"
[0m10:51:16.706716 [debug] [Thread-1 (]: On model.ecommerce_dbt.mart_sales_summary: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "ecommerce_profile", "target_name": "dev", "node_id": "model.ecommerce_dbt.mart_sales_summary"} */
drop view if exists "ecommerce"."analytics"."mart_sales_summary__dbt_backup" cascade
[0m10:51:16.709881 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m10:51:16.712555 [debug] [Thread-1 (]: On model.ecommerce_dbt.mart_sales_summary: Close
[0m10:51:16.714941 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eea18d80-8e2a-4296-8204-ab7d5981d985', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x710977ca3a50>]}
[0m10:51:16.717161 [info ] [Thread-1 (]: 2 of 2 OK created sql view model analytics.mart_sales_summary .................. [[32mCREATE VIEW[0m in 0.10s]
[0m10:51:16.719349 [debug] [Thread-1 (]: Finished running node model.ecommerce_dbt.mart_sales_summary
[0m10:51:16.722667 [debug] [MainThread]: Using postgres connection "master"
[0m10:51:16.724646 [debug] [MainThread]: On master: BEGIN
[0m10:51:16.731265 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:51:16.738581 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m10:51:16.740652 [debug] [MainThread]: On master: COMMIT
[0m10:51:16.743588 [debug] [MainThread]: Using postgres connection "master"
[0m10:51:16.745796 [debug] [MainThread]: On master: COMMIT
[0m10:51:16.747844 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:51:16.750079 [debug] [MainThread]: On master: Close
[0m10:51:16.751889 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:51:16.753253 [debug] [MainThread]: Connection 'model.ecommerce_dbt.mart_sales_summary' was properly closed.
[0m10:51:16.755116 [info ] [MainThread]: 
[0m10:51:16.756531 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 0.56 seconds (0.56s).
[0m10:51:16.759683 [debug] [MainThread]: Command end result
[0m10:51:16.806044 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m10:51:16.814129 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m10:51:16.827301 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt/target/run_results.json
[0m10:51:16.829621 [info ] [MainThread]: 
[0m10:51:16.831558 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:51:16.833511 [info ] [MainThread]: 
[0m10:51:16.835043 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m10:51:16.837310 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.7159008, "process_in_blocks": "0", "process_kernel_time": 0.309857, "process_mem_max_rss": "118964", "process_out_blocks": "0", "process_user_time": 2.3888}
[0m10:51:16.839295 [debug] [MainThread]: Command `dbt run` succeeded at 10:51:16.839168 after 1.72 seconds
[0m10:51:16.840927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71097b066910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71097e311310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71097e3940d0>]}
[0m10:51:16.843824 [debug] [MainThread]: Flushing usage events
[0m10:51:17.798481 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:51:19.909684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x781d25385ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x781d25361950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x781d25385090>]}


============================== 10:51:19.916659 | f910f949-8c66-4bea-9283-951ebd332571 ==============================
[0m10:51:19.916659 [info ] [MainThread]: Running with dbt=1.10.13
[0m10:51:19.919245 [debug] [MainThread]: running dbt with arguments {'log_path': '/opt/airflow/dbt/logs', 'static_parser': 'True', 'partial_parse': 'True', 'indirect_selection': 'eager', 'write_json': 'True', 'version_check': 'True', 'cache_selected_only': 'False', 'debug': 'False', 'empty': 'None', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'no_print': 'None', 'target_path': 'None', 'quiet': 'False', 'log_format': 'default', 'printer_width': '80', 'invocation_command': 'dbt test --profiles-dir .', 'use_colors': 'True', 'introspect': 'True', 'profiles_dir': '.', 'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'warn_error': 'None', 'use_experimental_parser': 'False'}
[0m10:51:20.121182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f910f949-8c66-4bea-9283-951ebd332571', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x781d27976850>]}
[0m10:51:20.174777 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f910f949-8c66-4bea-9283-951ebd332571', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x781d27e36190>]}
[0m10:51:20.176981 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m10:51:20.255263 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m10:51:20.459117 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:51:20.460756 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:51:20.488190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f910f949-8c66-4bea-9283-951ebd332571', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x781d23969a10>]}
[0m10:51:20.597264 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m10:51:20.609381 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m10:51:20.656830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f910f949-8c66-4bea-9283-951ebd332571', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x781d2361d010>]}
[0m10:51:20.660163 [info ] [MainThread]: Found 2 models, 1 seed, 447 macros
[0m10:51:20.661979 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f910f949-8c66-4bea-9283-951ebd332571', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x781d23667350>]}
[0m10:51:20.665496 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m10:51:20.668552 [debug] [MainThread]: Command end result
[0m10:51:20.698495 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m10:51:20.706788 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m10:51:20.719105 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt/target/run_results.json
[0m10:51:20.722252 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.8833187, "process_in_blocks": "1224", "process_kernel_time": 0.306226, "process_mem_max_rss": "113840", "process_out_blocks": "0", "process_user_time": 2.075088}
[0m10:51:20.724517 [debug] [MainThread]: Command `dbt test` succeeded at 10:51:20.724299 after 0.89 seconds
[0m10:51:20.726440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x781d253b3410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x781d253b2990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x781d2925d310>]}
[0m10:51:20.728077 [debug] [MainThread]: Flushing usage events
[0m10:51:21.663114 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:00:58.315509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77e30a34b690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77e30a349350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77e30a3490d0>]}


============================== 11:00:58.323432 | d807459f-4941-4721-a265-b02adc104a80 ==============================
[0m11:00:58.323432 [info ] [MainThread]: Running with dbt=1.10.13
[0m11:00:58.325747 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'log_path': '/opt/airflow/dbt/logs', 'partial_parse': 'True', 'no_print': 'None', 'warn_error': 'None', 'empty': 'None', 'introspect': 'True', 'profiles_dir': '/opt/airflow/dbt', 'log_cache_events': 'False', 'log_format': 'default', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'target_path': 'None', 'use_colors': 'True', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'printer_width': '80', 'fail_fast': 'False', 'debug': 'False', 'cache_selected_only': 'False', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'quiet': 'False', 'invocation_command': 'dbt deps'}
[0m11:00:58.460240 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd807459f-4941-4721-a265-b02adc104a80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77e30a09e7d0>]}
[0m11:00:58.472902 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m11:00:58.486076 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m11:00:58.488524 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.23833615, "process_in_blocks": "32", "process_kernel_time": 0.275908, "process_mem_max_rss": "101508", "process_out_blocks": "40", "process_user_time": 1.744712}
[0m11:00:58.490094 [debug] [MainThread]: Command `dbt deps` succeeded at 11:00:58.489944 after 0.24 seconds
[0m11:00:58.491764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77e30a537550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77e30a3490d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77e30e2b5310>]}
[0m11:00:58.493022 [debug] [MainThread]: Flushing usage events
[0m11:00:59.597495 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:01:01.902295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7376764a6e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7376768f3990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7376764a5a10>]}


============================== 11:01:01.909940 | 37277d26-3945-4a46-9c36-0b79ac526229 ==============================
[0m11:01:01.909940 [info ] [MainThread]: Running with dbt=1.10.13
[0m11:01:01.911864 [debug] [MainThread]: running dbt with arguments {'indirect_selection': 'eager', 'log_format': 'default', 'use_colors': 'True', 'printer_width': '80', 'quiet': 'False', 'empty': 'None', 'introspect': 'True', 'use_experimental_parser': 'False', 'write_json': 'True', 'target_path': 'None', 'no_print': 'None', 'cache_selected_only': 'False', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'debug': 'False', 'invocation_command': 'dbt seed --profiles-dir .', 'log_path': '/opt/airflow/dbt/logs', 'warn_error': 'None', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'profiles_dir': '.', 'log_cache_events': 'False', 'static_parser': 'True'}
[0m11:01:02.073151 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '37277d26-3945-4a46-9c36-0b79ac526229', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x737674ddac50>]}
[0m11:01:02.130908 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '37277d26-3945-4a46-9c36-0b79ac526229', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73767919c490>]}
[0m11:01:02.132865 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m11:01:02.212936 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m11:01:02.548914 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:01:02.550912 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:01:02.580586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '37277d26-3945-4a46-9c36-0b79ac526229', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x737674b12010>]}
[0m11:01:02.674687 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m11:01:02.689202 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m11:01:02.724786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '37277d26-3945-4a46-9c36-0b79ac526229', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x737674a0e910>]}
[0m11:01:02.726321 [info ] [MainThread]: Found 2 models, 1 seed, 447 macros
[0m11:01:02.729129 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '37277d26-3945-4a46-9c36-0b79ac526229', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7376789c8050>]}
[0m11:01:02.732369 [info ] [MainThread]: 
[0m11:01:02.734362 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:01:02.736099 [info ] [MainThread]: 
[0m11:01:02.738172 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:01:02.741132 [debug] [ThreadPool]: Acquiring new postgres connection 'list_ecommerce'
[0m11:01:02.775353 [debug] [ThreadPool]: Using postgres connection "list_ecommerce"
[0m11:01:02.779224 [debug] [ThreadPool]: On list_ecommerce: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "ecommerce_profile", "target_name": "dev", "connection_name": "list_ecommerce"} */

    select distinct nspname from pg_namespace
  
[0m11:01:02.782424 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:01:02.795272 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.013 seconds
[0m11:01:02.797816 [debug] [ThreadPool]: On list_ecommerce: Close
[0m11:01:02.800644 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ecommerce, now create_ecommerce_analytics)
[0m11:01:02.802290 [debug] [ThreadPool]: Creating schema "database: "ecommerce"
schema: "analytics"
"
[0m11:01:02.808534 [debug] [ThreadPool]: Using postgres connection "create_ecommerce_analytics"
[0m11:01:02.809869 [debug] [ThreadPool]: On create_ecommerce_analytics: BEGIN
[0m11:01:02.811326 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:01:02.818661 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m11:01:02.820039 [debug] [ThreadPool]: Using postgres connection "create_ecommerce_analytics"
[0m11:01:02.821905 [debug] [ThreadPool]: On create_ecommerce_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "ecommerce_profile", "target_name": "dev", "connection_name": "create_ecommerce_analytics"} */
create schema if not exists "analytics"
[0m11:01:02.824073 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.001 seconds
[0m11:01:02.826215 [debug] [ThreadPool]: On create_ecommerce_analytics: COMMIT
[0m11:01:02.829223 [debug] [ThreadPool]: Using postgres connection "create_ecommerce_analytics"
[0m11:01:02.830767 [debug] [ThreadPool]: On create_ecommerce_analytics: COMMIT
[0m11:01:02.856487 [debug] [ThreadPool]: SQL status: COMMIT in 0.024 seconds
[0m11:01:02.858265 [debug] [ThreadPool]: On create_ecommerce_analytics: Close
[0m11:01:02.865236 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_ecommerce_analytics, now list_ecommerce_analytics)
[0m11:01:02.873852 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_analytics"
[0m11:01:02.876920 [debug] [ThreadPool]: On list_ecommerce_analytics: BEGIN
[0m11:01:02.878581 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:01:02.888225 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m11:01:02.890547 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_analytics"
[0m11:01:02.892406 [debug] [ThreadPool]: On list_ecommerce_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "ecommerce_profile", "target_name": "dev", "connection_name": "list_ecommerce_analytics"} */
select
      'ecommerce' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'ecommerce' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'ecommerce' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m11:01:02.898260 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.004 seconds
[0m11:01:02.901448 [debug] [ThreadPool]: On list_ecommerce_analytics: ROLLBACK
[0m11:01:02.903625 [debug] [ThreadPool]: On list_ecommerce_analytics: Close
[0m11:01:02.910429 [debug] [MainThread]: Using postgres connection "master"
[0m11:01:02.912293 [debug] [MainThread]: On master: BEGIN
[0m11:01:02.914183 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:01:02.924020 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m11:01:02.926202 [debug] [MainThread]: Using postgres connection "master"
[0m11:01:02.927656 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "ecommerce_profile", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m11:01:02.932847 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m11:01:02.935296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '37277d26-3945-4a46-9c36-0b79ac526229', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x737674a47190>]}
[0m11:01:02.936939 [debug] [MainThread]: On master: ROLLBACK
[0m11:01:02.939218 [debug] [MainThread]: Using postgres connection "master"
[0m11:01:02.940917 [debug] [MainThread]: On master: BEGIN
[0m11:01:02.943104 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m11:01:02.944429 [debug] [MainThread]: On master: COMMIT
[0m11:01:02.945890 [debug] [MainThread]: Using postgres connection "master"
[0m11:01:02.947464 [debug] [MainThread]: On master: COMMIT
[0m11:01:02.949340 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m11:01:02.950745 [debug] [MainThread]: On master: Close
[0m11:01:02.955872 [debug] [Thread-1 (]: Began running node seed.ecommerce_dbt.sales_seed
[0m11:01:02.957390 [info ] [Thread-1 (]: 1 of 1 START seed file analytics.sales_seed .................................... [RUN]
[0m11:01:02.960114 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ecommerce_analytics, now seed.ecommerce_dbt.sales_seed)
[0m11:01:02.961718 [debug] [Thread-1 (]: Began compiling node seed.ecommerce_dbt.sales_seed
[0m11:01:02.963399 [debug] [Thread-1 (]: Began executing node seed.ecommerce_dbt.sales_seed
[0m11:01:02.989058 [debug] [Thread-1 (]: Using postgres connection "seed.ecommerce_dbt.sales_seed"
[0m11:01:02.990315 [debug] [Thread-1 (]: On seed.ecommerce_dbt.sales_seed: BEGIN
[0m11:01:02.991758 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:01:02.999161 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m11:01:03.000637 [debug] [Thread-1 (]: Using postgres connection "seed.ecommerce_dbt.sales_seed"
[0m11:01:03.002098 [debug] [Thread-1 (]: On seed.ecommerce_dbt.sales_seed: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "ecommerce_profile", "target_name": "dev", "node_id": "seed.ecommerce_dbt.sales_seed"} */

    create table "ecommerce"."analytics"."sales_seed" ("order_id" text,"order_date" date,"customer_id" text,"product_id" text,"quantity" integer,"price" float8)
  
[0m11:01:03.008298 [debug] [Thread-1 (]: SQL status: CREATE TABLE in 0.004 seconds
[0m11:01:03.023716 [debug] [Thread-1 (]: Using postgres connection "seed.ecommerce_dbt.sales_seed"
[0m11:01:03.025050 [debug] [Thread-1 (]: On seed.ecommerce_dbt.sales_seed: 
          insert into "ecommerce"."analytics"."sales_seed" ("order_id", "order_date", "customer_id", "product_id", "quantity", "price") values
          (%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s)
      ...
[0m11:01:03.027890 [debug] [Thread-1 (]: SQL status: INSERT 0 5 in 0.001 seconds
[0m11:01:03.033284 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.ecommerce_dbt.sales_seed"
[0m11:01:03.059395 [debug] [Thread-1 (]: On seed.ecommerce_dbt.sales_seed: COMMIT
[0m11:01:03.062010 [debug] [Thread-1 (]: Using postgres connection "seed.ecommerce_dbt.sales_seed"
[0m11:01:03.063711 [debug] [Thread-1 (]: On seed.ecommerce_dbt.sales_seed: COMMIT
[0m11:01:03.067932 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m11:01:03.070561 [debug] [Thread-1 (]: On seed.ecommerce_dbt.sales_seed: Close
[0m11:01:03.074464 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '37277d26-3945-4a46-9c36-0b79ac526229', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x737674cc57d0>]}
[0m11:01:03.076297 [info ] [Thread-1 (]: 1 of 1 OK loaded seed file analytics.sales_seed ................................ [[32mINSERT 5[0m in 0.11s]
[0m11:01:03.078795 [debug] [Thread-1 (]: Finished running node seed.ecommerce_dbt.sales_seed
[0m11:01:03.082396 [debug] [MainThread]: Using postgres connection "master"
[0m11:01:03.084588 [debug] [MainThread]: On master: BEGIN
[0m11:01:03.086108 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:01:03.094957 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m11:01:03.096499 [debug] [MainThread]: On master: COMMIT
[0m11:01:03.097851 [debug] [MainThread]: Using postgres connection "master"
[0m11:01:03.099144 [debug] [MainThread]: On master: COMMIT
[0m11:01:03.100663 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m11:01:03.101878 [debug] [MainThread]: On master: Close
[0m11:01:03.103520 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:01:03.105000 [debug] [MainThread]: Connection 'seed.ecommerce_dbt.sales_seed' was properly closed.
[0m11:01:03.106144 [info ] [MainThread]: 
[0m11:01:03.107442 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 0.37 seconds (0.37s).
[0m11:01:03.109473 [debug] [MainThread]: Command end result
[0m11:01:03.154134 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m11:01:03.164133 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m11:01:03.184148 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt/target/run_results.json
[0m11:01:03.185572 [info ] [MainThread]: 
[0m11:01:03.186939 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:01:03.189269 [info ] [MainThread]: 
[0m11:01:03.192653 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m11:01:03.194731 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 1.3682878, "process_in_blocks": "0", "process_kernel_time": 0.337097, "process_mem_max_rss": "119224", "process_out_blocks": "0", "process_user_time": 2.408417}
[0m11:01:03.197579 [debug] [MainThread]: Command `dbt seed` succeeded at 11:01:03.197318 after 1.37 seconds
[0m11:01:03.199321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x737676837710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73767a78d7d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73767a638150>]}
[0m11:01:03.201117 [debug] [MainThread]: Flushing usage events
[0m11:01:04.274364 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:01:06.525438 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74c863e04410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74c863e056d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74c863e2ec90>]}


============================== 11:01:06.532593 | feda4d8a-a8b8-4ad0-8ac3-cae1f56db5dd ==============================
[0m11:01:06.532593 [info ] [MainThread]: Running with dbt=1.10.13
[0m11:01:06.534456 [debug] [MainThread]: running dbt with arguments {'fail_fast': 'False', 'target_path': 'None', 'use_experimental_parser': 'False', 'log_path': '/opt/airflow/dbt/logs', 'no_print': 'None', 'use_colors': 'True', 'empty': 'False', 'partial_parse': 'True', 'profiles_dir': '.', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'log_cache_events': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error': 'None', 'version_check': 'True', 'write_json': 'True', 'cache_selected_only': 'False', 'indirect_selection': 'eager', 'debug': 'False', 'printer_width': '80', 'quiet': 'False', 'invocation_command': 'dbt run --profiles-dir .'}
[0m11:01:06.760902 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'feda4d8a-a8b8-4ad0-8ac3-cae1f56db5dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74c866534cd0>]}
[0m11:01:06.857091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'feda4d8a-a8b8-4ad0-8ac3-cae1f56db5dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74c8668b43d0>]}
[0m11:01:06.860173 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m11:01:06.958968 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m11:01:07.146941 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:01:07.149799 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:01:07.177834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'feda4d8a-a8b8-4ad0-8ac3-cae1f56db5dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74c862260490>]}
[0m11:01:07.259901 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m11:01:07.270537 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m11:01:07.327408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'feda4d8a-a8b8-4ad0-8ac3-cae1f56db5dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74c86237d8d0>]}
[0m11:01:07.329857 [info ] [MainThread]: Found 2 models, 1 seed, 447 macros
[0m11:01:07.333301 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'feda4d8a-a8b8-4ad0-8ac3-cae1f56db5dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74c8622a5e90>]}
[0m11:01:07.341245 [info ] [MainThread]: 
[0m11:01:07.343459 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:01:07.345834 [info ] [MainThread]: 
[0m11:01:07.347649 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:01:07.353531 [debug] [ThreadPool]: Acquiring new postgres connection 'list_ecommerce'
[0m11:01:07.381847 [debug] [ThreadPool]: Using postgres connection "list_ecommerce"
[0m11:01:07.383664 [debug] [ThreadPool]: On list_ecommerce: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "ecommerce_profile", "target_name": "dev", "connection_name": "list_ecommerce"} */

    select distinct nspname from pg_namespace
  
[0m11:01:07.385234 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:01:07.396236 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.011 seconds
[0m11:01:07.399196 [debug] [ThreadPool]: On list_ecommerce: Close
[0m11:01:07.402909 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ecommerce, now list_ecommerce_analytics)
[0m11:01:07.409851 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_analytics"
[0m11:01:07.411484 [debug] [ThreadPool]: On list_ecommerce_analytics: BEGIN
[0m11:01:07.413116 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:01:07.421651 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m11:01:07.423926 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_analytics"
[0m11:01:07.425898 [debug] [ThreadPool]: On list_ecommerce_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "ecommerce_profile", "target_name": "dev", "connection_name": "list_ecommerce_analytics"} */
select
      'ecommerce' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'ecommerce' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'ecommerce' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m11:01:07.431151 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.003 seconds
[0m11:01:07.434269 [debug] [ThreadPool]: On list_ecommerce_analytics: ROLLBACK
[0m11:01:07.435851 [debug] [ThreadPool]: On list_ecommerce_analytics: Close
[0m11:01:07.441688 [debug] [MainThread]: Using postgres connection "master"
[0m11:01:07.443124 [debug] [MainThread]: On master: BEGIN
[0m11:01:07.444377 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:01:07.451653 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m11:01:07.453090 [debug] [MainThread]: Using postgres connection "master"
[0m11:01:07.454807 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "ecommerce_profile", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m11:01:07.459300 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m11:01:07.461381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'feda4d8a-a8b8-4ad0-8ac3-cae1f56db5dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74c861782090>]}
[0m11:01:07.463093 [debug] [MainThread]: On master: ROLLBACK
[0m11:01:07.464963 [debug] [MainThread]: Using postgres connection "master"
[0m11:01:07.466501 [debug] [MainThread]: On master: BEGIN
[0m11:01:07.468408 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m11:01:07.469677 [debug] [MainThread]: On master: COMMIT
[0m11:01:07.471733 [debug] [MainThread]: Using postgres connection "master"
[0m11:01:07.473302 [debug] [MainThread]: On master: COMMIT
[0m11:01:07.475506 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m11:01:07.477391 [debug] [MainThread]: On master: Close
[0m11:01:07.483405 [debug] [Thread-1 (]: Began running node model.ecommerce_dbt.stg_sales
[0m11:01:07.485215 [info ] [Thread-1 (]: 1 of 2 START sql view model analytics.stg_sales ................................ [RUN]
[0m11:01:07.487836 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ecommerce_analytics, now model.ecommerce_dbt.stg_sales)
[0m11:01:07.489530 [debug] [Thread-1 (]: Began compiling node model.ecommerce_dbt.stg_sales
[0m11:01:07.496456 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_dbt.stg_sales"
[0m11:01:07.508615 [debug] [Thread-1 (]: Began executing node model.ecommerce_dbt.stg_sales
[0m11:01:07.537643 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_dbt.stg_sales"
[0m11:01:07.554727 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_dbt.stg_sales"
[0m11:01:07.556874 [debug] [Thread-1 (]: On model.ecommerce_dbt.stg_sales: BEGIN
[0m11:01:07.559261 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:01:07.572501 [debug] [Thread-1 (]: SQL status: BEGIN in 0.013 seconds
[0m11:01:07.588662 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_dbt.stg_sales"
[0m11:01:07.590862 [debug] [Thread-1 (]: On model.ecommerce_dbt.stg_sales: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "ecommerce_profile", "target_name": "dev", "node_id": "model.ecommerce_dbt.stg_sales"} */

  create view "ecommerce"."analytics"."stg_sales__dbt_tmp"
    
    
  as (
    with raw as (
  select
    order_id,
    order_date::date as order_date,
    customer_id,
    product_id,
    quantity,
    price
  from raw.sales
)

select * from raw
  );
[0m11:01:07.596543 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m11:01:07.609475 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_dbt.stg_sales"
[0m11:01:07.612127 [debug] [Thread-1 (]: On model.ecommerce_dbt.stg_sales: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "ecommerce_profile", "target_name": "dev", "node_id": "model.ecommerce_dbt.stg_sales"} */
alter table "ecommerce"."analytics"."stg_sales__dbt_tmp" rename to "stg_sales"
[0m11:01:07.615134 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:01:07.634519 [debug] [Thread-1 (]: On model.ecommerce_dbt.stg_sales: COMMIT
[0m11:01:07.637959 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_dbt.stg_sales"
[0m11:01:07.641230 [debug] [Thread-1 (]: On model.ecommerce_dbt.stg_sales: COMMIT
[0m11:01:07.646311 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m11:01:07.656749 [debug] [Thread-1 (]: Applying DROP to: "ecommerce"."analytics"."stg_sales__dbt_backup"
[0m11:01:07.665981 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_dbt.stg_sales"
[0m11:01:07.669156 [debug] [Thread-1 (]: On model.ecommerce_dbt.stg_sales: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "ecommerce_profile", "target_name": "dev", "node_id": "model.ecommerce_dbt.stg_sales"} */
drop view if exists "ecommerce"."analytics"."stg_sales__dbt_backup" cascade
[0m11:01:07.672237 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m11:01:07.676972 [debug] [Thread-1 (]: On model.ecommerce_dbt.stg_sales: Close
[0m11:01:07.680697 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'feda4d8a-a8b8-4ad0-8ac3-cae1f56db5dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74c8625e6810>]}
[0m11:01:07.683441 [info ] [Thread-1 (]: 1 of 2 OK created sql view model analytics.stg_sales ........................... [[32mCREATE VIEW[0m in 0.19s]
[0m11:01:07.686353 [debug] [Thread-1 (]: Finished running node model.ecommerce_dbt.stg_sales
[0m11:01:07.689911 [debug] [Thread-1 (]: Began running node model.ecommerce_dbt.mart_sales_summary
[0m11:01:07.692044 [info ] [Thread-1 (]: 2 of 2 START sql view model analytics.mart_sales_summary ....................... [RUN]
[0m11:01:07.694246 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ecommerce_dbt.stg_sales, now model.ecommerce_dbt.mart_sales_summary)
[0m11:01:07.696221 [debug] [Thread-1 (]: Began compiling node model.ecommerce_dbt.mart_sales_summary
[0m11:01:07.703463 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_dbt.mart_sales_summary"
[0m11:01:07.728060 [debug] [Thread-1 (]: Began executing node model.ecommerce_dbt.mart_sales_summary
[0m11:01:07.733787 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_dbt.mart_sales_summary"
[0m11:01:07.757076 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_dbt.mart_sales_summary"
[0m11:01:07.760032 [debug] [Thread-1 (]: On model.ecommerce_dbt.mart_sales_summary: BEGIN
[0m11:01:07.764891 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:01:07.777208 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m11:01:07.778892 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_dbt.mart_sales_summary"
[0m11:01:07.781441 [debug] [Thread-1 (]: On model.ecommerce_dbt.mart_sales_summary: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "ecommerce_profile", "target_name": "dev", "node_id": "model.ecommerce_dbt.mart_sales_summary"} */

  create view "ecommerce"."analytics"."mart_sales_summary__dbt_tmp"
    
    
  as (
    with sales as (
  select order_date, quantity, price, quantity * price as sales_amount
  from "ecommerce"."analytics"."stg_sales"
)
select
  order_date,
  sum(quantity) as total_items,
  sum(sales_amount) as total_revenue
from sales
group by order_date
order by order_date
  );
[0m11:01:07.786519 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m11:01:07.793203 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_dbt.mart_sales_summary"
[0m11:01:07.795437 [debug] [Thread-1 (]: On model.ecommerce_dbt.mart_sales_summary: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "ecommerce_profile", "target_name": "dev", "node_id": "model.ecommerce_dbt.mart_sales_summary"} */
alter table "ecommerce"."analytics"."mart_sales_summary__dbt_tmp" rename to "mart_sales_summary"
[0m11:01:07.797798 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:01:07.803576 [debug] [Thread-1 (]: On model.ecommerce_dbt.mart_sales_summary: COMMIT
[0m11:01:07.805719 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_dbt.mart_sales_summary"
[0m11:01:07.807366 [debug] [Thread-1 (]: On model.ecommerce_dbt.mart_sales_summary: COMMIT
[0m11:01:07.834582 [debug] [Thread-1 (]: SQL status: COMMIT in 0.025 seconds
[0m11:01:07.839864 [debug] [Thread-1 (]: Applying DROP to: "ecommerce"."analytics"."mart_sales_summary__dbt_backup"
[0m11:01:07.842322 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_dbt.mart_sales_summary"
[0m11:01:07.844093 [debug] [Thread-1 (]: On model.ecommerce_dbt.mart_sales_summary: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "ecommerce_profile", "target_name": "dev", "node_id": "model.ecommerce_dbt.mart_sales_summary"} */
drop view if exists "ecommerce"."analytics"."mart_sales_summary__dbt_backup" cascade
[0m11:01:07.846453 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m11:01:07.848793 [debug] [Thread-1 (]: On model.ecommerce_dbt.mart_sales_summary: Close
[0m11:01:07.851375 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'feda4d8a-a8b8-4ad0-8ac3-cae1f56db5dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74c86166b310>]}
[0m11:01:07.853757 [info ] [Thread-1 (]: 2 of 2 OK created sql view model analytics.mart_sales_summary .................. [[32mCREATE VIEW[0m in 0.16s]
[0m11:01:07.855810 [debug] [Thread-1 (]: Finished running node model.ecommerce_dbt.mart_sales_summary
[0m11:01:07.860041 [debug] [MainThread]: Using postgres connection "master"
[0m11:01:07.863076 [debug] [MainThread]: On master: BEGIN
[0m11:01:07.864810 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:01:07.873677 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m11:01:07.876339 [debug] [MainThread]: On master: COMMIT
[0m11:01:07.878039 [debug] [MainThread]: Using postgres connection "master"
[0m11:01:07.879625 [debug] [MainThread]: On master: COMMIT
[0m11:01:07.881955 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m11:01:07.884759 [debug] [MainThread]: On master: Close
[0m11:01:07.886957 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:01:07.890687 [debug] [MainThread]: Connection 'model.ecommerce_dbt.mart_sales_summary' was properly closed.
[0m11:01:07.893740 [info ] [MainThread]: 
[0m11:01:07.896156 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 0.55 seconds (0.55s).
[0m11:01:07.900244 [debug] [MainThread]: Command end result
[0m11:01:07.987837 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m11:01:08.004586 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m11:01:08.030375 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt/target/run_results.json
[0m11:01:08.032660 [info ] [MainThread]: 
[0m11:01:08.039097 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:01:08.042861 [info ] [MainThread]: 
[0m11:01:08.048825 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m11:01:08.053316 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.6034374, "process_in_blocks": "0", "process_kernel_time": 0.346186, "process_mem_max_rss": "119140", "process_out_blocks": "0", "process_user_time": 2.512909}
[0m11:01:08.057161 [debug] [MainThread]: Command `dbt run` succeeded at 11:01:08.056851 after 1.61 seconds
[0m11:01:08.060157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74c867cdd310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74c8642f8d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74c867d63850>]}
[0m11:01:08.062580 [debug] [MainThread]: Flushing usage events
[0m11:01:09.197225 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:01:11.489814 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e15f375e110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e15f373a0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e15f3789e50>]}


============================== 11:01:11.495815 | b9f461d5-0785-406c-b6d7-b2be61d8baa8 ==============================
[0m11:01:11.495815 [info ] [MainThread]: Running with dbt=1.10.13
[0m11:01:11.499688 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'cache_selected_only': 'False', 'introspect': 'True', 'version_check': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': '/opt/airflow/dbt/logs', 'use_colors': 'True', 'warn_error': 'None', 'log_cache_events': 'False', 'debug': 'False', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'target_path': 'None', 'quiet': 'False', 'write_json': 'True', 'profiles_dir': '.', 'empty': 'None', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'invocation_command': 'dbt test --profiles-dir .', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager'}
[0m11:01:11.659078 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b9f461d5-0785-406c-b6d7-b2be61d8baa8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e15f373dad0>]}
[0m11:01:11.705374 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b9f461d5-0785-406c-b6d7-b2be61d8baa8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e15f6291110>]}
[0m11:01:11.711790 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m11:01:11.812531 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m11:01:12.038471 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:01:12.044270 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:01:12.080055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b9f461d5-0785-406c-b6d7-b2be61d8baa8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e15f1bbc6d0>]}
[0m11:01:12.226366 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m11:01:12.250188 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m11:01:12.300963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b9f461d5-0785-406c-b6d7-b2be61d8baa8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e15f19e53d0>]}
[0m11:01:12.304263 [info ] [MainThread]: Found 2 models, 1 seed, 447 macros
[0m11:01:12.306586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b9f461d5-0785-406c-b6d7-b2be61d8baa8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e15f1a33790>]}
[0m11:01:12.310632 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m11:01:12.314587 [debug] [MainThread]: Command end result
[0m11:01:12.368021 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m11:01:12.379023 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m11:01:12.390907 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt/target/run_results.json
[0m11:01:12.394104 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.9689352, "process_in_blocks": "0", "process_kernel_time": 0.285912, "process_mem_max_rss": "113412", "process_out_blocks": "0", "process_user_time": 2.234946}
[0m11:01:12.396507 [debug] [MainThread]: Command `dbt test` succeeded at 11:01:12.396277 after 0.97 seconds
[0m11:01:12.398072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e15f37f1e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e15f1d03c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e15f76ad010>]}
[0m11:01:12.400352 [debug] [MainThread]: Flushing usage events
[0m11:01:13.580785 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:06:49.381902 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32f1594710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32f1597910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32f15c65d0>]}


============================== 11:06:49.390523 | 3033a975-d297-40fd-a601-9d7984a73c2f ==============================
[0m11:06:49.390523 [info ] [MainThread]: Running with dbt=1.10.13
[0m11:06:49.392787 [debug] [MainThread]: running dbt with arguments {'use_colors': 'True', 'target_path': 'None', 'log_cache_events': 'False', 'no_print': 'None', 'log_format': 'default', 'warn_error': 'None', 'invocation_command': 'dbt deps', 'printer_width': '80', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'use_experimental_parser': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'quiet': 'False', 'write_json': 'True', 'cache_selected_only': 'False', 'partial_parse': 'True', 'debug': 'False', 'empty': 'None', 'profiles_dir': '/opt/airflow/dbt', 'static_parser': 'True', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'introspect': 'True'}
[0m11:06:49.571762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3033a975-d297-40fd-a601-9d7984a73c2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32f145c150>]}
[0m11:06:49.594170 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m11:06:49.613653 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m11:06:49.617962 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.31362998, "process_in_blocks": "0", "process_kernel_time": 0.237015, "process_mem_max_rss": "101592", "process_out_blocks": "40", "process_user_time": 1.83185}
[0m11:06:49.619512 [debug] [MainThread]: Command `dbt deps` succeeded at 11:06:49.619319 after 0.32 seconds
[0m11:06:49.620940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32f13e64d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32f13e5f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32f562b250>]}
[0m11:06:49.622278 [debug] [MainThread]: Flushing usage events
[0m11:06:50.613622 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:06:52.568433 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7600efafa210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7600effb38d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7600efb61a10>]}


============================== 11:06:52.574580 | 9b6c5d4a-6456-44fd-bc33-c434737e778d ==============================
[0m11:06:52.574580 [info ] [MainThread]: Running with dbt=1.10.13
[0m11:06:52.576439 [debug] [MainThread]: running dbt with arguments {'log_cache_events': 'False', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'invocation_command': 'dbt seed --profiles-dir .', 'debug': 'False', 'write_json': 'True', 'log_path': '/opt/airflow/dbt/logs', 'introspect': 'True', 'printer_width': '80', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'profiles_dir': '.', 'quiet': 'False', 'target_path': 'None', 'cache_selected_only': 'False', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_colors': 'True', 'version_check': 'True', 'empty': 'None', 'warn_error': 'None', 'log_format': 'default', 'static_parser': 'True'}
[0m11:06:52.741776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9b6c5d4a-6456-44fd-bc33-c434737e778d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7600ee229bd0>]}
[0m11:06:52.791500 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9b6c5d4a-6456-44fd-bc33-c434737e778d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7600f257cb90>]}
[0m11:06:52.794157 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m11:06:52.872535 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m11:06:53.033781 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:06:53.035368 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:06:53.062231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9b6c5d4a-6456-44fd-bc33-c434737e778d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7600edf0fad0>]}
[0m11:06:53.131343 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m11:06:53.139852 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m11:06:53.167071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9b6c5d4a-6456-44fd-bc33-c434737e778d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7600ee073110>]}
[0m11:06:53.172689 [info ] [MainThread]: Found 2 models, 1 seed, 447 macros
[0m11:06:53.177873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9b6c5d4a-6456-44fd-bc33-c434737e778d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7600ee131e90>]}
[0m11:06:53.180737 [info ] [MainThread]: 
[0m11:06:53.181886 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:06:53.183219 [info ] [MainThread]: 
[0m11:06:53.184727 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:06:53.187244 [debug] [ThreadPool]: Acquiring new postgres connection 'list_ecommerce'
[0m11:06:53.212291 [debug] [ThreadPool]: Using postgres connection "list_ecommerce"
[0m11:06:53.213637 [debug] [ThreadPool]: On list_ecommerce: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "ecommerce_profile", "target_name": "dev", "connection_name": "list_ecommerce"} */

    select distinct nspname from pg_namespace
  
[0m11:06:53.215074 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:06:53.223493 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.008 seconds
[0m11:06:53.226871 [debug] [ThreadPool]: On list_ecommerce: Close
[0m11:06:53.231923 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ecommerce, now list_ecommerce_analytics)
[0m11:06:53.237735 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_analytics"
[0m11:06:53.239179 [debug] [ThreadPool]: On list_ecommerce_analytics: BEGIN
[0m11:06:53.240838 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:06:53.248094 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m11:06:53.249790 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_analytics"
[0m11:06:53.253107 [debug] [ThreadPool]: On list_ecommerce_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "ecommerce_profile", "target_name": "dev", "connection_name": "list_ecommerce_analytics"} */
select
      'ecommerce' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'ecommerce' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'ecommerce' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m11:06:53.260087 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.004 seconds
[0m11:06:53.263872 [debug] [ThreadPool]: On list_ecommerce_analytics: ROLLBACK
[0m11:06:53.265696 [debug] [ThreadPool]: On list_ecommerce_analytics: Close
[0m11:06:53.271729 [debug] [MainThread]: Using postgres connection "master"
[0m11:06:53.273158 [debug] [MainThread]: On master: BEGIN
[0m11:06:53.274392 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:06:53.282401 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m11:06:53.283880 [debug] [MainThread]: Using postgres connection "master"
[0m11:06:53.286999 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "ecommerce_profile", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m11:06:53.291974 [debug] [MainThread]: SQL status: SELECT 2 in 0.003 seconds
[0m11:06:53.295111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9b6c5d4a-6456-44fd-bc33-c434737e778d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7600edf27390>]}
[0m11:06:53.297559 [debug] [MainThread]: On master: ROLLBACK
[0m11:06:53.299324 [debug] [MainThread]: Using postgres connection "master"
[0m11:06:53.300832 [debug] [MainThread]: On master: BEGIN
[0m11:06:53.302811 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m11:06:53.304286 [debug] [MainThread]: On master: COMMIT
[0m11:06:53.305386 [debug] [MainThread]: Using postgres connection "master"
[0m11:06:53.306513 [debug] [MainThread]: On master: COMMIT
[0m11:06:53.308307 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m11:06:53.309553 [debug] [MainThread]: On master: Close
[0m11:06:53.316929 [debug] [Thread-1 (]: Began running node seed.ecommerce_dbt.sales_seed
[0m11:06:53.318705 [info ] [Thread-1 (]: 1 of 1 START seed file analytics.sales_seed .................................... [RUN]
[0m11:06:53.320177 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ecommerce_analytics, now seed.ecommerce_dbt.sales_seed)
[0m11:06:53.321438 [debug] [Thread-1 (]: Began compiling node seed.ecommerce_dbt.sales_seed
[0m11:06:53.322529 [debug] [Thread-1 (]: Began executing node seed.ecommerce_dbt.sales_seed
[0m11:06:53.359571 [debug] [Thread-1 (]: Using postgres connection "seed.ecommerce_dbt.sales_seed"
[0m11:06:53.363892 [debug] [Thread-1 (]: On seed.ecommerce_dbt.sales_seed: BEGIN
[0m11:06:53.365500 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:06:53.374164 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m11:06:53.379857 [debug] [Thread-1 (]: Using postgres connection "seed.ecommerce_dbt.sales_seed"
[0m11:06:53.383113 [debug] [Thread-1 (]: On seed.ecommerce_dbt.sales_seed: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "ecommerce_profile", "target_name": "dev", "node_id": "seed.ecommerce_dbt.sales_seed"} */
truncate table "ecommerce"."analytics"."sales_seed"
[0m11:06:53.390592 [debug] [Thread-1 (]: SQL status: TRUNCATE TABLE in 0.005 seconds
[0m11:06:53.414088 [debug] [Thread-1 (]: Using postgres connection "seed.ecommerce_dbt.sales_seed"
[0m11:06:53.417107 [debug] [Thread-1 (]: On seed.ecommerce_dbt.sales_seed: 
          insert into "ecommerce"."analytics"."sales_seed" ("order_id", "order_date", "customer_id", "product_id", "quantity", "price") values
          (%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s)
      ...
[0m11:06:53.420682 [debug] [Thread-1 (]: SQL status: INSERT 0 5 in 0.001 seconds
[0m11:06:53.427205 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.ecommerce_dbt.sales_seed"
[0m11:06:53.460470 [debug] [Thread-1 (]: On seed.ecommerce_dbt.sales_seed: COMMIT
[0m11:06:53.462638 [debug] [Thread-1 (]: Using postgres connection "seed.ecommerce_dbt.sales_seed"
[0m11:06:53.465745 [debug] [Thread-1 (]: On seed.ecommerce_dbt.sales_seed: COMMIT
[0m11:06:53.470702 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m11:06:53.474955 [debug] [Thread-1 (]: On seed.ecommerce_dbt.sales_seed: Close
[0m11:06:53.479158 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9b6c5d4a-6456-44fd-bc33-c434737e778d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7600ede42c90>]}
[0m11:06:53.481979 [info ] [Thread-1 (]: 1 of 1 OK loaded seed file analytics.sales_seed ................................ [[32mINSERT 5[0m in 0.16s]
[0m11:06:53.484533 [debug] [Thread-1 (]: Finished running node seed.ecommerce_dbt.sales_seed
[0m11:06:53.487903 [debug] [MainThread]: Using postgres connection "master"
[0m11:06:53.489684 [debug] [MainThread]: On master: BEGIN
[0m11:06:53.490996 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:06:53.498372 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m11:06:53.502492 [debug] [MainThread]: On master: COMMIT
[0m11:06:53.506324 [debug] [MainThread]: Using postgres connection "master"
[0m11:06:53.508286 [debug] [MainThread]: On master: COMMIT
[0m11:06:53.510496 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m11:06:53.513147 [debug] [MainThread]: On master: Close
[0m11:06:53.515889 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:06:53.518441 [debug] [MainThread]: Connection 'seed.ecommerce_dbt.sales_seed' was properly closed.
[0m11:06:53.520122 [info ] [MainThread]: 
[0m11:06:53.522477 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 0.34 seconds (0.34s).
[0m11:06:53.524618 [debug] [MainThread]: Command end result
[0m11:06:53.573136 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m11:06:53.584573 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m11:06:53.604236 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt/target/run_results.json
[0m11:06:53.606094 [info ] [MainThread]: 
[0m11:06:53.610571 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:06:53.612501 [info ] [MainThread]: 
[0m11:06:53.614532 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m11:06:53.617208 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 1.1291885, "process_in_blocks": "0", "process_kernel_time": 0.22326, "process_mem_max_rss": "119340", "process_out_blocks": "0", "process_user_time": 2.116986}
[0m11:06:53.618965 [debug] [MainThread]: Command `dbt seed` succeeded at 11:06:53.618784 after 1.13 seconds
[0m11:06:53.620970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7600f39a5310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7600ee2b89d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7600f3a2b850>]}
[0m11:06:53.622388 [debug] [MainThread]: Flushing usage events
[0m11:06:54.623995 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:06:56.813055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73c21e8f4dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73c21eaa1cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73c21e8f6190>]}


============================== 11:06:56.819466 | cb45d4da-0ce7-47f1-b6a0-1c151a5ebecf ==============================
[0m11:06:56.819466 [info ] [MainThread]: Running with dbt=1.10.13
[0m11:06:56.821162 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'printer_width': '80', 'use_colors': 'True', 'static_parser': 'True', 'partial_parse': 'True', 'profiles_dir': '.', 'use_experimental_parser': 'False', 'send_anonymous_usage_stats': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'no_print': 'None', 'debug': 'False', 'fail_fast': 'False', 'indirect_selection': 'eager', 'log_format': 'default', 'version_check': 'True', 'target_path': 'None', 'write_json': 'True', 'invocation_command': 'dbt run --profiles-dir .', 'quiet': 'False', 'empty': 'False', 'introspect': 'True', 'log_path': '/opt/airflow/dbt/logs', 'warn_error': 'None', 'log_cache_events': 'False'}
[0m11:06:57.009201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cb45d4da-0ce7-47f1-b6a0-1c151a5ebecf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73c21e8f4810>]}
[0m11:06:57.063052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cb45d4da-0ce7-47f1-b6a0-1c151a5ebecf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73c2215f68d0>]}
[0m11:06:57.065564 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m11:06:57.158856 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m11:06:57.372295 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:06:57.374311 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:06:57.405223 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cb45d4da-0ce7-47f1-b6a0-1c151a5ebecf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73c21cf54810>]}
[0m11:06:57.505197 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m11:06:57.518066 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m11:06:57.559273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cb45d4da-0ce7-47f1-b6a0-1c151a5ebecf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73c21ce62990>]}
[0m11:06:57.561267 [info ] [MainThread]: Found 2 models, 1 seed, 447 macros
[0m11:06:57.567408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cb45d4da-0ce7-47f1-b6a0-1c151a5ebecf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73c21eabaa50>]}
[0m11:06:57.572548 [info ] [MainThread]: 
[0m11:06:57.574266 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:06:57.576019 [info ] [MainThread]: 
[0m11:06:57.579050 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:06:57.584980 [debug] [ThreadPool]: Acquiring new postgres connection 'list_ecommerce'
[0m11:06:57.618004 [debug] [ThreadPool]: Using postgres connection "list_ecommerce"
[0m11:06:57.619911 [debug] [ThreadPool]: On list_ecommerce: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "ecommerce_profile", "target_name": "dev", "connection_name": "list_ecommerce"} */

    select distinct nspname from pg_namespace
  
[0m11:06:57.621210 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:06:57.632910 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.012 seconds
[0m11:06:57.636217 [debug] [ThreadPool]: On list_ecommerce: Close
[0m11:06:57.639841 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ecommerce, now list_ecommerce_analytics)
[0m11:06:57.647497 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_analytics"
[0m11:06:57.649823 [debug] [ThreadPool]: On list_ecommerce_analytics: BEGIN
[0m11:06:57.652048 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:06:57.660575 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m11:06:57.662605 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_analytics"
[0m11:06:57.666439 [debug] [ThreadPool]: On list_ecommerce_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "ecommerce_profile", "target_name": "dev", "connection_name": "list_ecommerce_analytics"} */
select
      'ecommerce' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'ecommerce' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'ecommerce' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m11:06:57.671329 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.003 seconds
[0m11:06:57.674001 [debug] [ThreadPool]: On list_ecommerce_analytics: ROLLBACK
[0m11:06:57.676414 [debug] [ThreadPool]: On list_ecommerce_analytics: Close
[0m11:06:57.685661 [debug] [MainThread]: Using postgres connection "master"
[0m11:06:57.687424 [debug] [MainThread]: On master: BEGIN
[0m11:06:57.689554 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:06:57.700379 [debug] [MainThread]: SQL status: BEGIN in 0.011 seconds
[0m11:06:57.702122 [debug] [MainThread]: Using postgres connection "master"
[0m11:06:57.704023 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "ecommerce_profile", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m11:06:57.711306 [debug] [MainThread]: SQL status: SELECT 2 in 0.005 seconds
[0m11:06:57.718408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cb45d4da-0ce7-47f1-b6a0-1c151a5ebecf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73c21cea9e50>]}
[0m11:06:57.720292 [debug] [MainThread]: On master: ROLLBACK
[0m11:06:57.723571 [debug] [MainThread]: Using postgres connection "master"
[0m11:06:57.725279 [debug] [MainThread]: On master: BEGIN
[0m11:06:57.728027 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m11:06:57.730945 [debug] [MainThread]: On master: COMMIT
[0m11:06:57.732904 [debug] [MainThread]: Using postgres connection "master"
[0m11:06:57.734295 [debug] [MainThread]: On master: COMMIT
[0m11:06:57.736364 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m11:06:57.738216 [debug] [MainThread]: On master: Close
[0m11:06:57.745211 [debug] [Thread-1 (]: Began running node model.ecommerce_dbt.stg_sales
[0m11:06:57.748489 [info ] [Thread-1 (]: 1 of 2 START sql view model analytics.stg_sales ................................ [RUN]
[0m11:06:57.751389 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ecommerce_analytics, now model.ecommerce_dbt.stg_sales)
[0m11:06:57.753327 [debug] [Thread-1 (]: Began compiling node model.ecommerce_dbt.stg_sales
[0m11:06:57.760393 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_dbt.stg_sales"
[0m11:06:57.775335 [debug] [Thread-1 (]: Began executing node model.ecommerce_dbt.stg_sales
[0m11:06:57.808117 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_dbt.stg_sales"
[0m11:06:57.822602 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_dbt.stg_sales"
[0m11:06:57.824822 [debug] [Thread-1 (]: On model.ecommerce_dbt.stg_sales: BEGIN
[0m11:06:57.827488 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:06:57.837120 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m11:06:57.838884 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_dbt.stg_sales"
[0m11:06:57.840942 [debug] [Thread-1 (]: On model.ecommerce_dbt.stg_sales: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "ecommerce_profile", "target_name": "dev", "node_id": "model.ecommerce_dbt.stg_sales"} */

  create view "ecommerce"."analytics"."stg_sales__dbt_tmp"
    
    
  as (
    with raw as (
  select
    order_id,
    order_date::date as order_date,
    customer_id,
    product_id,
    quantity,
    price
  from raw.sales
)

select * from raw
  );
[0m11:06:57.846166 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m11:06:57.854454 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_dbt.stg_sales"
[0m11:06:57.856703 [debug] [Thread-1 (]: On model.ecommerce_dbt.stg_sales: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "ecommerce_profile", "target_name": "dev", "node_id": "model.ecommerce_dbt.stg_sales"} */
alter table "ecommerce"."analytics"."stg_sales" rename to "stg_sales__dbt_backup"
[0m11:06:57.859873 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:06:57.867229 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_dbt.stg_sales"
[0m11:06:57.869391 [debug] [Thread-1 (]: On model.ecommerce_dbt.stg_sales: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "ecommerce_profile", "target_name": "dev", "node_id": "model.ecommerce_dbt.stg_sales"} */
alter table "ecommerce"."analytics"."stg_sales__dbt_tmp" rename to "stg_sales"
[0m11:06:57.872948 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:06:57.895357 [debug] [Thread-1 (]: On model.ecommerce_dbt.stg_sales: COMMIT
[0m11:06:57.899085 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_dbt.stg_sales"
[0m11:06:57.903428 [debug] [Thread-1 (]: On model.ecommerce_dbt.stg_sales: COMMIT
[0m11:06:57.917714 [debug] [Thread-1 (]: SQL status: COMMIT in 0.007 seconds
[0m11:06:57.927610 [debug] [Thread-1 (]: Applying DROP to: "ecommerce"."analytics"."stg_sales__dbt_backup"
[0m11:06:57.936345 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_dbt.stg_sales"
[0m11:06:57.938916 [debug] [Thread-1 (]: On model.ecommerce_dbt.stg_sales: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "ecommerce_profile", "target_name": "dev", "node_id": "model.ecommerce_dbt.stg_sales"} */
drop view if exists "ecommerce"."analytics"."stg_sales__dbt_backup" cascade
[0m11:06:57.944409 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.004 seconds
[0m11:06:57.949664 [debug] [Thread-1 (]: On model.ecommerce_dbt.stg_sales: Close
[0m11:06:57.953542 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cb45d4da-0ce7-47f1-b6a0-1c151a5ebecf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73c21e9af810>]}
[0m11:06:57.956120 [info ] [Thread-1 (]: 1 of 2 OK created sql view model analytics.stg_sales ........................... [[32mCREATE VIEW[0m in 0.20s]
[0m11:06:57.958843 [debug] [Thread-1 (]: Finished running node model.ecommerce_dbt.stg_sales
[0m11:06:57.961899 [debug] [Thread-1 (]: Began running node model.ecommerce_dbt.mart_sales_summary
[0m11:06:57.964605 [info ] [Thread-1 (]: 2 of 2 START sql view model analytics.mart_sales_summary ....................... [RUN]
[0m11:06:57.966697 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ecommerce_dbt.stg_sales, now model.ecommerce_dbt.mart_sales_summary)
[0m11:06:57.969070 [debug] [Thread-1 (]: Began compiling node model.ecommerce_dbt.mart_sales_summary
[0m11:06:57.973678 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_dbt.mart_sales_summary"
[0m11:06:57.987917 [debug] [Thread-1 (]: Began executing node model.ecommerce_dbt.mart_sales_summary
[0m11:06:57.993107 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_dbt.mart_sales_summary"
[0m11:06:58.008484 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_dbt.mart_sales_summary"
[0m11:06:58.010739 [debug] [Thread-1 (]: On model.ecommerce_dbt.mart_sales_summary: BEGIN
[0m11:06:58.013581 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:06:58.021736 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m11:06:58.023455 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_dbt.mart_sales_summary"
[0m11:06:58.025651 [debug] [Thread-1 (]: On model.ecommerce_dbt.mart_sales_summary: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "ecommerce_profile", "target_name": "dev", "node_id": "model.ecommerce_dbt.mart_sales_summary"} */

  create view "ecommerce"."analytics"."mart_sales_summary__dbt_tmp"
    
    
  as (
    with sales as (
  select order_date, quantity, price, quantity * price as sales_amount
  from "ecommerce"."analytics"."stg_sales"
)
select
  order_date,
  sum(quantity) as total_items,
  sum(sales_amount) as total_revenue
from sales
group by order_date
order by order_date
  );
[0m11:06:58.031335 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m11:06:58.035791 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_dbt.mart_sales_summary"
[0m11:06:58.037426 [debug] [Thread-1 (]: On model.ecommerce_dbt.mart_sales_summary: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "ecommerce_profile", "target_name": "dev", "node_id": "model.ecommerce_dbt.mart_sales_summary"} */
alter table "ecommerce"."analytics"."mart_sales_summary__dbt_tmp" rename to "mart_sales_summary"
[0m11:06:58.039870 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:06:58.042377 [debug] [Thread-1 (]: On model.ecommerce_dbt.mart_sales_summary: COMMIT
[0m11:06:58.043819 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_dbt.mart_sales_summary"
[0m11:06:58.045915 [debug] [Thread-1 (]: On model.ecommerce_dbt.mart_sales_summary: COMMIT
[0m11:06:58.050554 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m11:06:58.053818 [debug] [Thread-1 (]: Applying DROP to: "ecommerce"."analytics"."mart_sales_summary__dbt_backup"
[0m11:06:58.055924 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_dbt.mart_sales_summary"
[0m11:06:58.057309 [debug] [Thread-1 (]: On model.ecommerce_dbt.mart_sales_summary: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "ecommerce_profile", "target_name": "dev", "node_id": "model.ecommerce_dbt.mart_sales_summary"} */
drop view if exists "ecommerce"."analytics"."mart_sales_summary__dbt_backup" cascade
[0m11:06:58.059559 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m11:06:58.062502 [debug] [Thread-1 (]: On model.ecommerce_dbt.mart_sales_summary: Close
[0m11:06:58.065508 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cb45d4da-0ce7-47f1-b6a0-1c151a5ebecf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73c21c351950>]}
[0m11:06:58.067727 [info ] [Thread-1 (]: 2 of 2 OK created sql view model analytics.mart_sales_summary .................. [[32mCREATE VIEW[0m in 0.10s]
[0m11:06:58.069545 [debug] [Thread-1 (]: Finished running node model.ecommerce_dbt.mart_sales_summary
[0m11:06:58.072640 [debug] [MainThread]: Using postgres connection "master"
[0m11:06:58.074335 [debug] [MainThread]: On master: BEGIN
[0m11:06:58.075819 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:06:58.083982 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m11:06:58.085691 [debug] [MainThread]: On master: COMMIT
[0m11:06:58.087624 [debug] [MainThread]: Using postgres connection "master"
[0m11:06:58.089177 [debug] [MainThread]: On master: COMMIT
[0m11:06:58.091062 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m11:06:58.092816 [debug] [MainThread]: On master: Close
[0m11:06:58.095016 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:06:58.097561 [debug] [MainThread]: Connection 'model.ecommerce_dbt.mart_sales_summary' was properly closed.
[0m11:06:58.099320 [info ] [MainThread]: 
[0m11:06:58.100998 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 0.52 seconds (0.52s).
[0m11:06:58.103255 [debug] [MainThread]: Command end result
[0m11:06:58.167474 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m11:06:58.177776 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m11:06:58.198939 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt/target/run_results.json
[0m11:06:58.201019 [info ] [MainThread]: 
[0m11:06:58.203059 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:06:58.206388 [info ] [MainThread]: 
[0m11:06:58.208322 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m11:06:58.211172 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.4705368, "process_in_blocks": "0", "process_kernel_time": 0.371812, "process_mem_max_rss": "119128", "process_out_blocks": "0", "process_user_time": 2.311702}
[0m11:06:58.213484 [debug] [MainThread]: Command `dbt run` succeeded at 11:06:58.213289 after 1.47 seconds
[0m11:06:58.215640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73c21e912490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73c21e912e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73c222a091d0>]}
[0m11:06:58.217776 [debug] [MainThread]: Flushing usage events
[0m11:06:59.248588 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:07:01.460811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b196cece190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b196cecd7d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b196cecdd90>]}


============================== 11:07:01.471269 | 1e1f4186-03f9-4bdb-80b3-6036be83a902 ==============================
[0m11:07:01.471269 [info ] [MainThread]: Running with dbt=1.10.13
[0m11:07:01.474302 [debug] [MainThread]: running dbt with arguments {'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'log_format': 'default', 'target_path': 'None', 'empty': 'None', 'debug': 'False', 'quiet': 'False', 'no_print': 'None', 'introspect': 'True', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'warn_error': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'log_cache_events': 'False', 'write_json': 'True', 'invocation_command': 'dbt test --profiles-dir .', 'use_colors': 'True', 'profiles_dir': '.', 'static_parser': 'True', 'partial_parse': 'True'}
[0m11:07:01.666373 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1e1f4186-03f9-4bdb-80b3-6036be83a902', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b196f675250>]}
[0m11:07:01.726733 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1e1f4186-03f9-4bdb-80b3-6036be83a902', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b196f9f0fd0>]}
[0m11:07:01.731322 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m11:07:01.855093 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m11:07:02.131536 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:07:02.138395 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:07:02.192608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1e1f4186-03f9-4bdb-80b3-6036be83a902', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b196b2b6350>]}
[0m11:07:02.288310 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m11:07:02.305887 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m11:07:02.369117 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1e1f4186-03f9-4bdb-80b3-6036be83a902', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b196b164f50>]}
[0m11:07:02.371834 [info ] [MainThread]: Found 2 models, 1 seed, 447 macros
[0m11:07:02.375655 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1e1f4186-03f9-4bdb-80b3-6036be83a902', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b196b1773d0>]}
[0m11:07:02.380289 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m11:07:02.383474 [debug] [MainThread]: Command end result
[0m11:07:02.439500 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m11:07:02.449998 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m11:07:02.470512 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt/target/run_results.json
[0m11:07:02.473524 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 1.0866207, "process_in_blocks": "0", "process_kernel_time": 0.334453, "process_mem_max_rss": "113436", "process_out_blocks": "0", "process_user_time": 2.206579}
[0m11:07:02.476004 [debug] [MainThread]: Command `dbt test` succeeded at 11:07:02.475769 after 1.09 seconds
[0m11:07:02.478441 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b196d0979d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b1970e09010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b1970e8c090>]}
[0m11:07:02.481169 [debug] [MainThread]: Flushing usage events
[0m11:07:03.403052 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:12:55.512991 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7979ef5e9010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7979ef5ee190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7979ef60cb10>]}


============================== 11:12:55.518120 | fc94d3e9-5881-4d01-9a65-dc1a39a1e8d2 ==============================
[0m11:12:55.518120 [info ] [MainThread]: Running with dbt=1.10.13
[0m11:12:55.524814 [debug] [MainThread]: running dbt with arguments {'empty': 'None', 'quiet': 'False', 'version_check': 'True', 'log_format': 'default', 'use_colors': 'True', 'send_anonymous_usage_stats': 'True', 'log_path': '/opt/airflow/dbt/logs', 'log_cache_events': 'False', 'target_path': 'None', 'invocation_command': 'dbt deps', 'warn_error': 'None', 'cache_selected_only': 'False', 'indirect_selection': 'eager', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/dbt', 'no_print': 'None', 'write_json': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'printer_width': '80', 'partial_parse': 'True', 'debug': 'False', 'use_experimental_parser': 'False'}
[0m11:12:55.667730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fc94d3e9-5881-4d01-9a65-dc1a39a1e8d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7979ef3344d0>]}
[0m11:12:55.685577 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m11:12:55.703162 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m11:12:55.709377 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.24593131, "process_in_blocks": "0", "process_kernel_time": 0.212019, "process_mem_max_rss": "101404", "process_out_blocks": "40", "process_user_time": 1.40413}
[0m11:12:55.711272 [debug] [MainThread]: Command `dbt deps` succeeded at 11:12:55.710963 after 0.25 seconds
[0m11:12:55.713414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7979ef88f710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7979ef45e910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7979f354d2d0>]}
[0m11:12:55.714806 [debug] [MainThread]: Flushing usage events
[0m11:12:56.843873 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:12:58.962295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a7be6194110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a7be61720d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a7be61c0c90>]}


============================== 11:12:58.969526 | 634a725d-f818-4a06-9d13-21b9c7771593 ==============================
[0m11:12:58.969526 [info ] [MainThread]: Running with dbt=1.10.13
[0m11:12:58.971728 [debug] [MainThread]: running dbt with arguments {'fail_fast': 'False', 'write_json': 'True', 'log_path': '/opt/airflow/dbt/logs', 'profiles_dir': '.', 'use_colors': 'True', 'version_check': 'True', 'log_cache_events': 'False', 'invocation_command': 'dbt seed --profiles-dir .', 'printer_width': '80', 'indirect_selection': 'eager', 'static_parser': 'True', 'introspect': 'True', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'empty': 'None', 'debug': 'False', 'warn_error': 'None', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'target_path': 'None', 'log_format': 'default', 'no_print': 'None'}
[0m11:12:59.111348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '634a725d-f818-4a06-9d13-21b9c7771593', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a7be635fdd0>]}
[0m11:12:59.165033 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '634a725d-f818-4a06-9d13-21b9c7771593', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a7be8cce010>]}
[0m11:12:59.166795 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m11:12:59.261886 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m11:12:59.458029 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:12:59.459275 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:12:59.484753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '634a725d-f818-4a06-9d13-21b9c7771593', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a7be4631610>]}
[0m11:12:59.544151 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m11:12:59.566668 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m11:12:59.628359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '634a725d-f818-4a06-9d13-21b9c7771593', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a7be47189d0>]}
[0m11:12:59.630799 [info ] [MainThread]: Found 2 models, 1 seed, 447 macros
[0m11:12:59.632269 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '634a725d-f818-4a06-9d13-21b9c7771593', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a7be48f1090>]}
[0m11:12:59.635549 [info ] [MainThread]: 
[0m11:12:59.637602 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:12:59.639449 [info ] [MainThread]: 
[0m11:12:59.642460 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:12:59.645093 [debug] [ThreadPool]: Acquiring new postgres connection 'list_ecommerce'
[0m11:12:59.673687 [debug] [ThreadPool]: Using postgres connection "list_ecommerce"
[0m11:12:59.676495 [debug] [ThreadPool]: On list_ecommerce: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "ecommerce_profile", "target_name": "dev", "connection_name": "list_ecommerce"} */

    select distinct nspname from pg_namespace
  
[0m11:12:59.678690 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:12:59.689556 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.011 seconds
[0m11:12:59.692764 [debug] [ThreadPool]: On list_ecommerce: Close
[0m11:12:59.700263 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ecommerce, now list_ecommerce_analytics)
[0m11:12:59.706746 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_analytics"
[0m11:12:59.709307 [debug] [ThreadPool]: On list_ecommerce_analytics: BEGIN
[0m11:12:59.711442 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:12:59.719272 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m11:12:59.726946 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_analytics"
[0m11:12:59.729299 [debug] [ThreadPool]: On list_ecommerce_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "ecommerce_profile", "target_name": "dev", "connection_name": "list_ecommerce_analytics"} */
select
      'ecommerce' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'ecommerce' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'ecommerce' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m11:12:59.735220 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.004 seconds
[0m11:12:59.739660 [debug] [ThreadPool]: On list_ecommerce_analytics: ROLLBACK
[0m11:12:59.741723 [debug] [ThreadPool]: On list_ecommerce_analytics: Close
[0m11:12:59.748203 [debug] [MainThread]: Using postgres connection "master"
[0m11:12:59.749922 [debug] [MainThread]: On master: BEGIN
[0m11:12:59.751299 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:12:59.760077 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m11:12:59.762279 [debug] [MainThread]: Using postgres connection "master"
[0m11:12:59.763912 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "ecommerce_profile", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m11:12:59.768527 [debug] [MainThread]: SQL status: SELECT 2 in 0.003 seconds
[0m11:12:59.772460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '634a725d-f818-4a06-9d13-21b9c7771593', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a7be4916410>]}
[0m11:12:59.774478 [debug] [MainThread]: On master: ROLLBACK
[0m11:12:59.776359 [debug] [MainThread]: Using postgres connection "master"
[0m11:12:59.778283 [debug] [MainThread]: On master: BEGIN
[0m11:12:59.780237 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m11:12:59.781891 [debug] [MainThread]: On master: COMMIT
[0m11:12:59.783398 [debug] [MainThread]: Using postgres connection "master"
[0m11:12:59.784694 [debug] [MainThread]: On master: COMMIT
[0m11:12:59.786789 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m11:12:59.789852 [debug] [MainThread]: On master: Close
[0m11:12:59.799874 [debug] [Thread-1 (]: Began running node seed.ecommerce_dbt.sales_seed
[0m11:12:59.801807 [info ] [Thread-1 (]: 1 of 1 START seed file analytics.sales_seed .................................... [RUN]
[0m11:12:59.804301 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ecommerce_analytics, now seed.ecommerce_dbt.sales_seed)
[0m11:12:59.805679 [debug] [Thread-1 (]: Began compiling node seed.ecommerce_dbt.sales_seed
[0m11:12:59.807784 [debug] [Thread-1 (]: Began executing node seed.ecommerce_dbt.sales_seed
[0m11:12:59.846741 [debug] [Thread-1 (]: Using postgres connection "seed.ecommerce_dbt.sales_seed"
[0m11:12:59.848816 [debug] [Thread-1 (]: On seed.ecommerce_dbt.sales_seed: BEGIN
[0m11:12:59.850884 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:12:59.860214 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m11:12:59.862648 [debug] [Thread-1 (]: Using postgres connection "seed.ecommerce_dbt.sales_seed"
[0m11:12:59.865384 [debug] [Thread-1 (]: On seed.ecommerce_dbt.sales_seed: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "ecommerce_profile", "target_name": "dev", "node_id": "seed.ecommerce_dbt.sales_seed"} */
truncate table "ecommerce"."analytics"."sales_seed"
[0m11:12:59.875103 [debug] [Thread-1 (]: SQL status: TRUNCATE TABLE in 0.008 seconds
[0m11:12:59.893366 [debug] [Thread-1 (]: Using postgres connection "seed.ecommerce_dbt.sales_seed"
[0m11:12:59.895466 [debug] [Thread-1 (]: On seed.ecommerce_dbt.sales_seed: 
          insert into "ecommerce"."analytics"."sales_seed" ("order_id", "order_date", "customer_id", "product_id", "quantity", "price") values
          (%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s)
      ...
[0m11:12:59.898412 [debug] [Thread-1 (]: SQL status: INSERT 0 5 in 0.001 seconds
[0m11:12:59.906886 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.ecommerce_dbt.sales_seed"
[0m11:12:59.931181 [debug] [Thread-1 (]: On seed.ecommerce_dbt.sales_seed: COMMIT
[0m11:12:59.933325 [debug] [Thread-1 (]: Using postgres connection "seed.ecommerce_dbt.sales_seed"
[0m11:12:59.934844 [debug] [Thread-1 (]: On seed.ecommerce_dbt.sales_seed: COMMIT
[0m11:12:59.940237 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m11:12:59.945222 [debug] [Thread-1 (]: On seed.ecommerce_dbt.sales_seed: Close
[0m11:12:59.948548 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '634a725d-f818-4a06-9d13-21b9c7771593', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a7be4843450>]}
[0m11:12:59.950772 [info ] [Thread-1 (]: 1 of 1 OK loaded seed file analytics.sales_seed ................................ [[32mINSERT 5[0m in 0.14s]
[0m11:12:59.953577 [debug] [Thread-1 (]: Finished running node seed.ecommerce_dbt.sales_seed
[0m11:12:59.958021 [debug] [MainThread]: Using postgres connection "master"
[0m11:12:59.960277 [debug] [MainThread]: On master: BEGIN
[0m11:12:59.961866 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:12:59.970055 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m11:12:59.971616 [debug] [MainThread]: On master: COMMIT
[0m11:12:59.973083 [debug] [MainThread]: Using postgres connection "master"
[0m11:12:59.975985 [debug] [MainThread]: On master: COMMIT
[0m11:12:59.979782 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m11:12:59.981198 [debug] [MainThread]: On master: Close
[0m11:12:59.983050 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:12:59.985318 [debug] [MainThread]: Connection 'seed.ecommerce_dbt.sales_seed' was properly closed.
[0m11:12:59.989535 [info ] [MainThread]: 
[0m11:12:59.991323 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 0.35 seconds (0.35s).
[0m11:12:59.993510 [debug] [MainThread]: Command end result
[0m11:13:00.057442 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m11:13:00.067244 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m11:13:00.088292 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt/target/run_results.json
[0m11:13:00.091567 [info ] [MainThread]: 
[0m11:13:00.094357 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:13:00.096232 [info ] [MainThread]: 
[0m11:13:00.098827 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m11:13:00.101237 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 1.2094394, "process_in_blocks": "0", "process_kernel_time": 0.339963, "process_mem_max_rss": "118976", "process_out_blocks": "0", "process_user_time": 2.189524}
[0m11:13:00.102974 [debug] [MainThread]: Command `dbt seed` succeeded at 11:13:00.102794 after 1.21 seconds
[0m11:13:00.105357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a7be61c3850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a7be5fe07d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a7bea0e5010>]}
[0m11:13:00.107395 [debug] [MainThread]: Flushing usage events
[0m11:13:01.229031 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:13:03.375822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7624c48eae50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7624c491f710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7624c4adf1d0>]}


============================== 11:13:03.382540 | 95d5801d-8e7b-475e-943f-28602db06bdb ==============================
[0m11:13:03.382540 [info ] [MainThread]: Running with dbt=1.10.13
[0m11:13:03.385686 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'write_json': 'True', 'static_parser': 'True', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'no_print': 'None', 'printer_width': '80', 'warn_error': 'None', 'profiles_dir': '.', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'quiet': 'False', 'fail_fast': 'False', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'log_format': 'default', 'cache_selected_only': 'False', 'log_cache_events': 'False', 'empty': 'False', 'use_colors': 'True', 'debug': 'False', 'invocation_command': 'dbt run --profiles-dir .'}
[0m11:13:03.591137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '95d5801d-8e7b-475e-943f-28602db06bdb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7624c309a190>]}
[0m11:13:03.728134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '95d5801d-8e7b-475e-943f-28602db06bdb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7624c2f50c10>]}
[0m11:13:03.731414 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m11:13:03.837469 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m11:13:04.111240 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:13:04.113829 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:13:04.144301 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '95d5801d-8e7b-475e-943f-28602db06bdb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7624c2d9a490>]}
[0m11:13:04.259477 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m11:13:04.276230 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m11:13:04.342486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '95d5801d-8e7b-475e-943f-28602db06bdb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7624c307efd0>]}
[0m11:13:04.346358 [info ] [MainThread]: Found 2 models, 1 seed, 447 macros
[0m11:13:04.349417 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '95d5801d-8e7b-475e-943f-28602db06bdb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7624c2d56290>]}
[0m11:13:04.352858 [info ] [MainThread]: 
[0m11:13:04.355522 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:13:04.357591 [info ] [MainThread]: 
[0m11:13:04.359905 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:13:04.368041 [debug] [ThreadPool]: Acquiring new postgres connection 'list_ecommerce'
[0m11:13:04.401644 [debug] [ThreadPool]: Using postgres connection "list_ecommerce"
[0m11:13:04.404230 [debug] [ThreadPool]: On list_ecommerce: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "ecommerce_profile", "target_name": "dev", "connection_name": "list_ecommerce"} */

    select distinct nspname from pg_namespace
  
[0m11:13:04.407448 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:13:04.416785 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.009 seconds
[0m11:13:04.420605 [debug] [ThreadPool]: On list_ecommerce: Close
[0m11:13:04.424952 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ecommerce, now list_ecommerce_analytics)
[0m11:13:04.431293 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_analytics"
[0m11:13:04.433164 [debug] [ThreadPool]: On list_ecommerce_analytics: BEGIN
[0m11:13:04.434649 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:13:04.444196 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m11:13:04.445717 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_analytics"
[0m11:13:04.449395 [debug] [ThreadPool]: On list_ecommerce_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "ecommerce_profile", "target_name": "dev", "connection_name": "list_ecommerce_analytics"} */
select
      'ecommerce' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'ecommerce' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'ecommerce' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m11:13:04.456813 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.005 seconds
[0m11:13:04.459928 [debug] [ThreadPool]: On list_ecommerce_analytics: ROLLBACK
[0m11:13:04.461989 [debug] [ThreadPool]: On list_ecommerce_analytics: Close
[0m11:13:04.469671 [debug] [MainThread]: Using postgres connection "master"
[0m11:13:04.472314 [debug] [MainThread]: On master: BEGIN
[0m11:13:04.474368 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:13:04.483003 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m11:13:04.484656 [debug] [MainThread]: Using postgres connection "master"
[0m11:13:04.488203 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "ecommerce_profile", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m11:13:04.492727 [debug] [MainThread]: SQL status: SELECT 2 in 0.003 seconds
[0m11:13:04.495151 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '95d5801d-8e7b-475e-943f-28602db06bdb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7624c2ea3390>]}
[0m11:13:04.496893 [debug] [MainThread]: On master: ROLLBACK
[0m11:13:04.498707 [debug] [MainThread]: Using postgres connection "master"
[0m11:13:04.500451 [debug] [MainThread]: On master: BEGIN
[0m11:13:04.503683 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m11:13:04.506603 [debug] [MainThread]: On master: COMMIT
[0m11:13:04.509382 [debug] [MainThread]: Using postgres connection "master"
[0m11:13:04.510792 [debug] [MainThread]: On master: COMMIT
[0m11:13:04.512797 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m11:13:04.514455 [debug] [MainThread]: On master: Close
[0m11:13:04.524049 [debug] [Thread-1 (]: Began running node model.ecommerce_dbt.stg_sales
[0m11:13:04.525838 [info ] [Thread-1 (]: 1 of 2 START sql view model analytics.stg_sales ................................ [RUN]
[0m11:13:04.527872 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ecommerce_analytics, now model.ecommerce_dbt.stg_sales)
[0m11:13:04.530645 [debug] [Thread-1 (]: Began compiling node model.ecommerce_dbt.stg_sales
[0m11:13:04.540664 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_dbt.stg_sales"
[0m11:13:04.555134 [debug] [Thread-1 (]: Began executing node model.ecommerce_dbt.stg_sales
[0m11:13:04.589154 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_dbt.stg_sales"
[0m11:13:04.600903 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_dbt.stg_sales"
[0m11:13:04.603360 [debug] [Thread-1 (]: On model.ecommerce_dbt.stg_sales: BEGIN
[0m11:13:04.606214 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:13:04.615215 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m11:13:04.617162 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_dbt.stg_sales"
[0m11:13:04.619575 [debug] [Thread-1 (]: On model.ecommerce_dbt.stg_sales: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "ecommerce_profile", "target_name": "dev", "node_id": "model.ecommerce_dbt.stg_sales"} */

  create view "ecommerce"."analytics"."stg_sales__dbt_tmp"
    
    
  as (
    with raw as (
  select
    order_id,
    order_date::date as order_date,
    customer_id,
    product_id,
    quantity,
    price
  from raw.sales
)

select * from raw
  );
[0m11:13:04.624496 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m11:13:04.632898 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_dbt.stg_sales"
[0m11:13:04.635207 [debug] [Thread-1 (]: On model.ecommerce_dbt.stg_sales: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "ecommerce_profile", "target_name": "dev", "node_id": "model.ecommerce_dbt.stg_sales"} */
alter table "ecommerce"."analytics"."stg_sales" rename to "stg_sales__dbt_backup"
[0m11:13:04.641331 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:13:04.646370 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_dbt.stg_sales"
[0m11:13:04.648547 [debug] [Thread-1 (]: On model.ecommerce_dbt.stg_sales: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "ecommerce_profile", "target_name": "dev", "node_id": "model.ecommerce_dbt.stg_sales"} */
alter table "ecommerce"."analytics"."stg_sales__dbt_tmp" rename to "stg_sales"
[0m11:13:04.651138 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:13:04.672047 [debug] [Thread-1 (]: On model.ecommerce_dbt.stg_sales: COMMIT
[0m11:13:04.674071 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_dbt.stg_sales"
[0m11:13:04.676900 [debug] [Thread-1 (]: On model.ecommerce_dbt.stg_sales: COMMIT
[0m11:13:04.703102 [debug] [Thread-1 (]: SQL status: COMMIT in 0.024 seconds
[0m11:13:04.712541 [debug] [Thread-1 (]: Applying DROP to: "ecommerce"."analytics"."stg_sales__dbt_backup"
[0m11:13:04.721327 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_dbt.stg_sales"
[0m11:13:04.723463 [debug] [Thread-1 (]: On model.ecommerce_dbt.stg_sales: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "ecommerce_profile", "target_name": "dev", "node_id": "model.ecommerce_dbt.stg_sales"} */
drop view if exists "ecommerce"."analytics"."stg_sales__dbt_backup" cascade
[0m11:13:04.728922 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.004 seconds
[0m11:13:04.732512 [debug] [Thread-1 (]: On model.ecommerce_dbt.stg_sales: Close
[0m11:13:04.736311 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '95d5801d-8e7b-475e-943f-28602db06bdb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7624c47f7910>]}
[0m11:13:04.739667 [info ] [Thread-1 (]: 1 of 2 OK created sql view model analytics.stg_sales ........................... [[32mCREATE VIEW[0m in 0.21s]
[0m11:13:04.741742 [debug] [Thread-1 (]: Finished running node model.ecommerce_dbt.stg_sales
[0m11:13:04.744341 [debug] [Thread-1 (]: Began running node model.ecommerce_dbt.mart_sales_summary
[0m11:13:04.746287 [info ] [Thread-1 (]: 2 of 2 START sql view model analytics.mart_sales_summary ....................... [RUN]
[0m11:13:04.748034 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ecommerce_dbt.stg_sales, now model.ecommerce_dbt.mart_sales_summary)
[0m11:13:04.749676 [debug] [Thread-1 (]: Began compiling node model.ecommerce_dbt.mart_sales_summary
[0m11:13:04.754992 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_dbt.mart_sales_summary"
[0m11:13:04.767841 [debug] [Thread-1 (]: Began executing node model.ecommerce_dbt.mart_sales_summary
[0m11:13:04.775372 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_dbt.mart_sales_summary"
[0m11:13:04.790468 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_dbt.mart_sales_summary"
[0m11:13:04.792420 [debug] [Thread-1 (]: On model.ecommerce_dbt.mart_sales_summary: BEGIN
[0m11:13:04.794613 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:13:04.803178 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m11:13:04.806273 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_dbt.mart_sales_summary"
[0m11:13:04.808497 [debug] [Thread-1 (]: On model.ecommerce_dbt.mart_sales_summary: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "ecommerce_profile", "target_name": "dev", "node_id": "model.ecommerce_dbt.mart_sales_summary"} */

  create view "ecommerce"."analytics"."mart_sales_summary__dbt_tmp"
    
    
  as (
    with sales as (
  select order_date, quantity, price, quantity * price as sales_amount
  from "ecommerce"."analytics"."stg_sales"
)
select
  order_date,
  sum(quantity) as total_items,
  sum(sales_amount) as total_revenue
from sales
group by order_date
order by order_date
  );
[0m11:13:04.812672 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m11:13:04.818161 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_dbt.mart_sales_summary"
[0m11:13:04.820535 [debug] [Thread-1 (]: On model.ecommerce_dbt.mart_sales_summary: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "ecommerce_profile", "target_name": "dev", "node_id": "model.ecommerce_dbt.mart_sales_summary"} */
alter table "ecommerce"."analytics"."mart_sales_summary__dbt_tmp" rename to "mart_sales_summary"
[0m11:13:04.823957 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:13:04.826912 [debug] [Thread-1 (]: On model.ecommerce_dbt.mart_sales_summary: COMMIT
[0m11:13:04.829150 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_dbt.mart_sales_summary"
[0m11:13:04.831071 [debug] [Thread-1 (]: On model.ecommerce_dbt.mart_sales_summary: COMMIT
[0m11:13:04.836317 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m11:13:04.841026 [debug] [Thread-1 (]: Applying DROP to: "ecommerce"."analytics"."mart_sales_summary__dbt_backup"
[0m11:13:04.843110 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_dbt.mart_sales_summary"
[0m11:13:04.844771 [debug] [Thread-1 (]: On model.ecommerce_dbt.mart_sales_summary: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "ecommerce_profile", "target_name": "dev", "node_id": "model.ecommerce_dbt.mart_sales_summary"} */
drop view if exists "ecommerce"."analytics"."mart_sales_summary__dbt_backup" cascade
[0m11:13:04.846735 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m11:13:04.849905 [debug] [Thread-1 (]: On model.ecommerce_dbt.mart_sales_summary: Close
[0m11:13:04.851643 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '95d5801d-8e7b-475e-943f-28602db06bdb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7624c22ceb10>]}
[0m11:13:04.855833 [info ] [Thread-1 (]: 2 of 2 OK created sql view model analytics.mart_sales_summary .................. [[32mCREATE VIEW[0m in 0.10s]
[0m11:13:04.858553 [debug] [Thread-1 (]: Finished running node model.ecommerce_dbt.mart_sales_summary
[0m11:13:04.863111 [debug] [MainThread]: Using postgres connection "master"
[0m11:13:04.865096 [debug] [MainThread]: On master: BEGIN
[0m11:13:04.866608 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:13:04.877059 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m11:13:04.878741 [debug] [MainThread]: On master: COMMIT
[0m11:13:04.880606 [debug] [MainThread]: Using postgres connection "master"
[0m11:13:04.882355 [debug] [MainThread]: On master: COMMIT
[0m11:13:04.884454 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m11:13:04.886778 [debug] [MainThread]: On master: Close
[0m11:13:04.890379 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:13:04.892084 [debug] [MainThread]: Connection 'model.ecommerce_dbt.mart_sales_summary' was properly closed.
[0m11:13:04.894849 [info ] [MainThread]: 
[0m11:13:04.896882 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 0.54 seconds (0.54s).
[0m11:13:04.899409 [debug] [MainThread]: Command end result
[0m11:13:04.949564 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m11:13:04.960228 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m11:13:04.976387 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt/target/run_results.json
[0m11:13:04.978322 [info ] [MainThread]: 
[0m11:13:04.980506 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:13:04.982553 [info ] [MainThread]: 
[0m11:13:04.984577 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m11:13:04.988417 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.6746829, "process_in_blocks": "0", "process_kernel_time": 0.437095, "process_mem_max_rss": "119252", "process_out_blocks": "0", "process_user_time": 2.378721}
[0m11:13:04.990958 [debug] [MainThread]: Command `dbt run` succeeded at 11:13:04.990798 after 1.68 seconds
[0m11:13:04.992790 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7624c624a290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7624c490cc90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7624c4fed090>]}
[0m11:13:04.994214 [debug] [MainThread]: Flushing usage events
[0m11:13:06.265674 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:13:08.614989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a58ed4d1e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a58ed4adfd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a58ed693ad0>]}


============================== 11:13:08.621471 | 9596f050-e62e-4c1f-8f19-739f80259b63 ==============================
[0m11:13:08.621471 [info ] [MainThread]: Running with dbt=1.10.13
[0m11:13:08.623459 [debug] [MainThread]: running dbt with arguments {'fail_fast': 'False', 'printer_width': '80', 'debug': 'False', 'partial_parse': 'True', 'profiles_dir': '.', 'log_format': 'default', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'no_print': 'None', 'use_colors': 'True', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'version_check': 'True', 'empty': 'None', 'cache_selected_only': 'False', 'quiet': 'False', 'invocation_command': 'dbt test --profiles-dir .', 'log_cache_events': 'False', 'target_path': 'None', 'log_path': '/opt/airflow/dbt/logs', 'static_parser': 'True', 'warn_error': 'None', 'introspect': 'True', 'write_json': 'True', 'use_experimental_parser': 'False'}
[0m11:13:08.817490 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9596f050-e62e-4c1f-8f19-739f80259b63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a58efa99d10>]}
[0m11:13:08.890592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9596f050-e62e-4c1f-8f19-739f80259b63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a58eff56390>]}
[0m11:13:08.893310 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m11:13:09.006549 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m11:13:09.196618 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:13:09.198762 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:13:09.246704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9596f050-e62e-4c1f-8f19-739f80259b63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a58eb930690>]}
[0m11:13:09.373681 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m11:13:09.387819 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m11:13:09.445509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9596f050-e62e-4c1f-8f19-739f80259b63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a58eb768ad0>]}
[0m11:13:09.447786 [info ] [MainThread]: Found 2 models, 1 seed, 447 macros
[0m11:13:09.450464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9596f050-e62e-4c1f-8f19-739f80259b63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a58eb77afd0>]}
[0m11:13:09.454652 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m11:13:09.459255 [debug] [MainThread]: Command end result
[0m11:13:09.513545 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m11:13:09.524716 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m11:13:09.536984 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt/target/run_results.json
[0m11:13:09.540976 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.9973045, "process_in_blocks": "0", "process_kernel_time": 0.273952, "process_mem_max_rss": "113396", "process_out_blocks": "0", "process_user_time": 2.364856}
[0m11:13:09.543601 [debug] [MainThread]: Command `dbt test` succeeded at 11:13:09.543434 after 1.00 seconds
[0m11:13:09.545848 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a58ed31ed90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a58ed693710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a58eb897110>]}
[0m11:13:09.548052 [debug] [MainThread]: Flushing usage events
[0m11:13:10.676669 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m04:47:04.827726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76d6908ad450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76d6908e1ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76d6908ad610>]}


============================== 04:47:04.836958 | b1cbce2c-2cea-462c-a33b-7898e0a54b83 ==============================
[0m04:47:04.836958 [info ] [MainThread]: Running with dbt=1.10.13
[0m04:47:04.838175 [debug] [MainThread]: running dbt with arguments {'send_anonymous_usage_stats': 'True', 'log_format': 'default', 'empty': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'printer_width': '80', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'quiet': 'False', 'log_cache_events': 'False', 'invocation_command': 'dbt deps', 'version_check': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'write_json': 'True', 'debug': 'False', 'no_print': 'None', 'introspect': 'True', 'indirect_selection': 'eager', 'partial_parse': 'True', 'fail_fast': 'False', 'static_parser': 'True', 'log_path': '/opt/airflow/dbt/logs', 'target_path': 'None', 'profiles_dir': '/opt/airflow/dbt'}
[0m04:47:05.054859 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b1cbce2c-2cea-462c-a33b-7898e0a54b83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76d69063ee90>]}
[0m04:47:05.076702 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m04:47:05.095829 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m04:47:05.099129 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.42199644, "process_in_blocks": "31280", "process_kernel_time": 0.327497, "process_mem_max_rss": "101372", "process_out_blocks": "40", "process_user_time": 1.956691}
[0m04:47:05.100869 [debug] [MainThread]: Command `dbt deps` succeeded at 04:47:05.100720 after 0.42 seconds
[0m04:47:05.102069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76d6933dfe50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76d6908d0110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76d694801250>]}
[0m04:47:05.103324 [debug] [MainThread]: Flushing usage events
[0m04:47:06.397719 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m04:47:08.441742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74ad172c1810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74ad172c1050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74ad172e9e10>]}


============================== 04:47:08.446880 | 4a7c4ee6-acff-49a0-9ba4-74081772ea3e ==============================
[0m04:47:08.446880 [info ] [MainThread]: Running with dbt=1.10.13
[0m04:47:08.448282 [debug] [MainThread]: running dbt with arguments {'empty': 'None', 'no_print': 'None', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'profiles_dir': '.', 'debug': 'False', 'use_colors': 'True', 'static_parser': 'True', 'quiet': 'False', 'log_path': '/opt/airflow/dbt/logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt seed --profiles-dir .', 'target_path': 'None', 'printer_width': '80', 'partial_parse': 'True', 'version_check': 'True', 'introspect': 'True', 'write_json': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m04:47:08.615303 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4a7c4ee6-acff-49a0-9ba4-74081772ea3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74ad15a83e50>]}
[0m04:47:08.661241 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4a7c4ee6-acff-49a0-9ba4-74081772ea3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74ad19e211d0>]}
[0m04:47:08.684897 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m04:47:08.828403 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m04:47:09.199698 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m04:47:09.200897 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m04:47:09.237851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4a7c4ee6-acff-49a0-9ba4-74081772ea3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74ad15abe010>]}
[0m04:47:09.343995 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m04:47:09.369889 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m04:47:09.447950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4a7c4ee6-acff-49a0-9ba4-74081772ea3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74ad157406d0>]}
[0m04:47:09.449349 [info ] [MainThread]: Found 2 models, 1 seed, 447 macros
[0m04:47:09.451649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4a7c4ee6-acff-49a0-9ba4-74081772ea3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74ad157401d0>]}
[0m04:47:09.454123 [info ] [MainThread]: 
[0m04:47:09.455062 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m04:47:09.456221 [info ] [MainThread]: 
[0m04:47:09.457565 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m04:47:09.463199 [debug] [ThreadPool]: Acquiring new postgres connection 'list_ecommerce'
[0m04:47:09.498025 [debug] [ThreadPool]: Using postgres connection "list_ecommerce"
[0m04:47:09.499271 [debug] [ThreadPool]: On list_ecommerce: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "ecommerce_profile", "target_name": "dev", "connection_name": "list_ecommerce"} */

    select distinct nspname from pg_namespace
  
[0m04:47:09.500228 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:47:09.507463 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.007 seconds
[0m04:47:09.511478 [debug] [ThreadPool]: On list_ecommerce: Close
[0m04:47:09.517111 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ecommerce, now list_ecommerce_analytics)
[0m04:47:09.522984 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_analytics"
[0m04:47:09.524024 [debug] [ThreadPool]: On list_ecommerce_analytics: BEGIN
[0m04:47:09.525754 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:47:09.534777 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m04:47:09.538063 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_analytics"
[0m04:47:09.540543 [debug] [ThreadPool]: On list_ecommerce_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "ecommerce_profile", "target_name": "dev", "connection_name": "list_ecommerce_analytics"} */
select
      'ecommerce' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'ecommerce' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'ecommerce' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m04:47:09.550953 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.007 seconds
[0m04:47:09.553020 [debug] [ThreadPool]: On list_ecommerce_analytics: ROLLBACK
[0m04:47:09.554149 [debug] [ThreadPool]: On list_ecommerce_analytics: Close
[0m04:47:09.559414 [debug] [MainThread]: Using postgres connection "master"
[0m04:47:09.560999 [debug] [MainThread]: On master: BEGIN
[0m04:47:09.562724 [debug] [MainThread]: Opening a new connection, currently in state init
[0m04:47:09.569002 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m04:47:09.570281 [debug] [MainThread]: Using postgres connection "master"
[0m04:47:09.571366 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "ecommerce_profile", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m04:47:09.581660 [debug] [MainThread]: SQL status: SELECT 2 in 0.009 seconds
[0m04:47:09.584035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4a7c4ee6-acff-49a0-9ba4-74081772ea3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74ad15507190>]}
[0m04:47:09.585176 [debug] [MainThread]: On master: ROLLBACK
[0m04:47:09.586437 [debug] [MainThread]: Using postgres connection "master"
[0m04:47:09.588190 [debug] [MainThread]: On master: BEGIN
[0m04:47:09.589484 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m04:47:09.590573 [debug] [MainThread]: On master: COMMIT
[0m04:47:09.593556 [debug] [MainThread]: Using postgres connection "master"
[0m04:47:09.597057 [debug] [MainThread]: On master: COMMIT
[0m04:47:09.598523 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m04:47:09.599765 [debug] [MainThread]: On master: Close
[0m04:47:09.605453 [debug] [Thread-1 (]: Began running node seed.ecommerce_dbt.sales_seed
[0m04:47:09.606726 [info ] [Thread-1 (]: 1 of 1 START seed file analytics.sales_seed .................................... [RUN]
[0m04:47:09.607889 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ecommerce_analytics, now seed.ecommerce_dbt.sales_seed)
[0m04:47:09.610498 [debug] [Thread-1 (]: Began compiling node seed.ecommerce_dbt.sales_seed
[0m04:47:09.613188 [debug] [Thread-1 (]: Began executing node seed.ecommerce_dbt.sales_seed
[0m04:47:09.643706 [debug] [Thread-1 (]: Using postgres connection "seed.ecommerce_dbt.sales_seed"
[0m04:47:09.645325 [debug] [Thread-1 (]: On seed.ecommerce_dbt.sales_seed: BEGIN
[0m04:47:09.646331 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:47:09.651986 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m04:47:09.653270 [debug] [Thread-1 (]: Using postgres connection "seed.ecommerce_dbt.sales_seed"
[0m04:47:09.655854 [debug] [Thread-1 (]: On seed.ecommerce_dbt.sales_seed: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "ecommerce_profile", "target_name": "dev", "node_id": "seed.ecommerce_dbt.sales_seed"} */
truncate table "ecommerce"."analytics"."sales_seed"
[0m04:47:09.663490 [debug] [Thread-1 (]: SQL status: TRUNCATE TABLE in 0.006 seconds
[0m04:47:09.681780 [debug] [Thread-1 (]: Using postgres connection "seed.ecommerce_dbt.sales_seed"
[0m04:47:09.683155 [debug] [Thread-1 (]: On seed.ecommerce_dbt.sales_seed: 
          insert into "ecommerce"."analytics"."sales_seed" ("order_id", "order_date", "customer_id", "product_id", "quantity", "price") values
          (%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s)
      ...
[0m04:47:09.684839 [debug] [Thread-1 (]: SQL status: INSERT 0 5 in 0.001 seconds
[0m04:47:09.689929 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.ecommerce_dbt.sales_seed"
[0m04:47:09.730417 [debug] [Thread-1 (]: On seed.ecommerce_dbt.sales_seed: COMMIT
[0m04:47:09.731829 [debug] [Thread-1 (]: Using postgres connection "seed.ecommerce_dbt.sales_seed"
[0m04:47:09.732791 [debug] [Thread-1 (]: On seed.ecommerce_dbt.sales_seed: COMMIT
[0m04:47:09.735791 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m04:47:09.737994 [debug] [Thread-1 (]: On seed.ecommerce_dbt.sales_seed: Close
[0m04:47:09.740496 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4a7c4ee6-acff-49a0-9ba4-74081772ea3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74ad14b61650>]}
[0m04:47:09.741681 [info ] [Thread-1 (]: 1 of 1 OK loaded seed file analytics.sales_seed ................................ [[32mINSERT 5[0m in 0.13s]
[0m04:47:09.743091 [debug] [Thread-1 (]: Finished running node seed.ecommerce_dbt.sales_seed
[0m04:47:09.745827 [debug] [MainThread]: Using postgres connection "master"
[0m04:47:09.746737 [debug] [MainThread]: On master: BEGIN
[0m04:47:09.747500 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m04:47:09.752818 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m04:47:09.754036 [debug] [MainThread]: On master: COMMIT
[0m04:47:09.755542 [debug] [MainThread]: Using postgres connection "master"
[0m04:47:09.757118 [debug] [MainThread]: On master: COMMIT
[0m04:47:09.760052 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m04:47:09.762005 [debug] [MainThread]: On master: Close
[0m04:47:09.763548 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:47:09.764497 [debug] [MainThread]: Connection 'seed.ecommerce_dbt.sales_seed' was properly closed.
[0m04:47:09.765469 [info ] [MainThread]: 
[0m04:47:09.766529 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 0.31 seconds (0.31s).
[0m04:47:09.768093 [debug] [MainThread]: Command end result
[0m04:47:09.809070 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m04:47:09.820335 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m04:47:09.863293 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt/target/run_results.json
[0m04:47:09.864974 [info ] [MainThread]: 
[0m04:47:09.866533 [info ] [MainThread]: [32mCompleted successfully[0m
[0m04:47:09.867810 [info ] [MainThread]: 
[0m04:47:09.869006 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m04:47:09.870943 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 1.485917, "process_in_blocks": "3944", "process_kernel_time": 0.263898, "process_mem_max_rss": "119844", "process_out_blocks": "0", "process_user_time": 2.22893}
[0m04:47:09.873861 [debug] [MainThread]: Command `dbt seed` succeeded at 04:47:09.873515 after 1.49 seconds
[0m04:47:09.880911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74ad175679d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74ad17136b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74ad1b239150>]}
[0m04:47:09.882025 [debug] [MainThread]: Flushing usage events
[0m04:47:11.280841 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m04:47:13.065577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73b14dabaa10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73b14d90f790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73b14e11b090>]}


============================== 04:47:13.070743 | fa829b4c-cd22-450a-a88a-9880864f057e ==============================
[0m04:47:13.070743 [info ] [MainThread]: Running with dbt=1.10.13
[0m04:47:13.072183 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'log_format': 'default', 'printer_width': '80', 'empty': 'False', 'log_cache_events': 'False', 'no_print': 'None', 'warn_error': 'None', 'use_experimental_parser': 'False', 'static_parser': 'True', 'introspect': 'True', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'cache_selected_only': 'False', 'quiet': 'False', 'invocation_command': 'dbt run --profiles-dir .', 'profiles_dir': '.', 'write_json': 'True', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': '/opt/airflow/dbt/logs', 'partial_parse': 'True', 'target_path': 'None'}
[0m04:47:13.221652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fa829b4c-cd22-450a-a88a-9880864f057e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73b14e186590>]}
[0m04:47:13.265550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fa829b4c-cd22-450a-a88a-9880864f057e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73b150612a90>]}
[0m04:47:13.269205 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m04:47:13.367764 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m04:47:13.552857 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m04:47:13.554153 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m04:47:13.579501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fa829b4c-cd22-450a-a88a-9880864f057e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73b14bf71090>]}
[0m04:47:13.698642 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m04:47:13.710526 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m04:47:13.736496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fa829b4c-cd22-450a-a88a-9880864f057e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73b14c188610>]}
[0m04:47:13.738485 [info ] [MainThread]: Found 2 models, 1 seed, 447 macros
[0m04:47:13.740124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fa829b4c-cd22-450a-a88a-9880864f057e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73b14be50350>]}
[0m04:47:13.743878 [info ] [MainThread]: 
[0m04:47:13.745498 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m04:47:13.746692 [info ] [MainThread]: 
[0m04:47:13.748010 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m04:47:13.751471 [debug] [ThreadPool]: Acquiring new postgres connection 'list_ecommerce'
[0m04:47:13.781353 [debug] [ThreadPool]: Using postgres connection "list_ecommerce"
[0m04:47:13.783112 [debug] [ThreadPool]: On list_ecommerce: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "ecommerce_profile", "target_name": "dev", "connection_name": "list_ecommerce"} */

    select distinct nspname from pg_namespace
  
[0m04:47:13.784990 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:47:13.797479 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.012 seconds
[0m04:47:13.799790 [debug] [ThreadPool]: On list_ecommerce: Close
[0m04:47:13.802464 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ecommerce, now list_ecommerce_analytics)
[0m04:47:13.808452 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_analytics"
[0m04:47:13.809641 [debug] [ThreadPool]: On list_ecommerce_analytics: BEGIN
[0m04:47:13.810912 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:47:13.817904 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m04:47:13.819764 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_analytics"
[0m04:47:13.821445 [debug] [ThreadPool]: On list_ecommerce_analytics: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "ecommerce_profile", "target_name": "dev", "connection_name": "list_ecommerce_analytics"} */
select
      'ecommerce' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'ecommerce' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'ecommerce' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m04:47:13.827495 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.003 seconds
[0m04:47:13.829772 [debug] [ThreadPool]: On list_ecommerce_analytics: ROLLBACK
[0m04:47:13.831242 [debug] [ThreadPool]: On list_ecommerce_analytics: Close
[0m04:47:13.837214 [debug] [MainThread]: Using postgres connection "master"
[0m04:47:13.839392 [debug] [MainThread]: On master: BEGIN
[0m04:47:13.841875 [debug] [MainThread]: Opening a new connection, currently in state init
[0m04:47:13.848750 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m04:47:13.850210 [debug] [MainThread]: Using postgres connection "master"
[0m04:47:13.851579 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "ecommerce_profile", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m04:47:13.855553 [debug] [MainThread]: SQL status: SELECT 2 in 0.003 seconds
[0m04:47:13.859813 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fa829b4c-cd22-450a-a88a-9880864f057e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73b14bcefb50>]}
[0m04:47:13.861752 [debug] [MainThread]: On master: ROLLBACK
[0m04:47:13.863600 [debug] [MainThread]: Using postgres connection "master"
[0m04:47:13.864752 [debug] [MainThread]: On master: BEGIN
[0m04:47:13.866698 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m04:47:13.868136 [debug] [MainThread]: On master: COMMIT
[0m04:47:13.869468 [debug] [MainThread]: Using postgres connection "master"
[0m04:47:13.870926 [debug] [MainThread]: On master: COMMIT
[0m04:47:13.872530 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m04:47:13.874319 [debug] [MainThread]: On master: Close
[0m04:47:13.884313 [debug] [Thread-1 (]: Began running node model.ecommerce_dbt.stg_sales
[0m04:47:13.887111 [info ] [Thread-1 (]: 1 of 2 START sql view model analytics.stg_sales ................................ [RUN]
[0m04:47:13.889621 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ecommerce_analytics, now model.ecommerce_dbt.stg_sales)
[0m04:47:13.891604 [debug] [Thread-1 (]: Began compiling node model.ecommerce_dbt.stg_sales
[0m04:47:13.903626 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_dbt.stg_sales"
[0m04:47:13.966525 [debug] [Thread-1 (]: Began executing node model.ecommerce_dbt.stg_sales
[0m04:47:14.051342 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_dbt.stg_sales"
[0m04:47:14.104328 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_dbt.stg_sales"
[0m04:47:14.106275 [debug] [Thread-1 (]: On model.ecommerce_dbt.stg_sales: BEGIN
[0m04:47:14.108843 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:47:14.118198 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m04:47:14.120593 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_dbt.stg_sales"
[0m04:47:14.121775 [debug] [Thread-1 (]: On model.ecommerce_dbt.stg_sales: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "ecommerce_profile", "target_name": "dev", "node_id": "model.ecommerce_dbt.stg_sales"} */

  create view "ecommerce"."analytics"."stg_sales__dbt_tmp"
    
    
  as (
    with raw as (
  select
    order_id,
    order_date::date as order_date,
    customer_id,
    product_id,
    quantity,
    price
  from raw.sales
)

select * from raw
  );
[0m04:47:14.135177 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.012 seconds
[0m04:47:14.145873 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_dbt.stg_sales"
[0m04:47:14.148520 [debug] [Thread-1 (]: On model.ecommerce_dbt.stg_sales: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "ecommerce_profile", "target_name": "dev", "node_id": "model.ecommerce_dbt.stg_sales"} */
alter table "ecommerce"."analytics"."stg_sales" rename to "stg_sales__dbt_backup"
[0m04:47:14.150581 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m04:47:14.153736 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_dbt.stg_sales"
[0m04:47:14.154954 [debug] [Thread-1 (]: On model.ecommerce_dbt.stg_sales: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "ecommerce_profile", "target_name": "dev", "node_id": "model.ecommerce_dbt.stg_sales"} */
alter table "ecommerce"."analytics"."stg_sales__dbt_tmp" rename to "stg_sales"
[0m04:47:14.156859 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m04:47:14.171664 [debug] [Thread-1 (]: On model.ecommerce_dbt.stg_sales: COMMIT
[0m04:47:14.173015 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_dbt.stg_sales"
[0m04:47:14.174208 [debug] [Thread-1 (]: On model.ecommerce_dbt.stg_sales: COMMIT
[0m04:47:14.176837 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m04:47:14.182578 [debug] [Thread-1 (]: Applying DROP to: "ecommerce"."analytics"."stg_sales__dbt_backup"
[0m04:47:14.186927 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_dbt.stg_sales"
[0m04:47:14.187876 [debug] [Thread-1 (]: On model.ecommerce_dbt.stg_sales: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "ecommerce_profile", "target_name": "dev", "node_id": "model.ecommerce_dbt.stg_sales"} */
drop view if exists "ecommerce"."analytics"."stg_sales__dbt_backup" cascade
[0m04:47:14.192518 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.004 seconds
[0m04:47:14.195245 [debug] [Thread-1 (]: On model.ecommerce_dbt.stg_sales: Close
[0m04:47:14.198143 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fa829b4c-cd22-450a-a88a-9880864f057e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73b14c22a5d0>]}
[0m04:47:14.199441 [info ] [Thread-1 (]: 1 of 2 OK created sql view model analytics.stg_sales ........................... [[32mCREATE VIEW[0m in 0.31s]
[0m04:47:14.200619 [debug] [Thread-1 (]: Finished running node model.ecommerce_dbt.stg_sales
[0m04:47:14.202134 [debug] [Thread-1 (]: Began running node model.ecommerce_dbt.mart_sales_summary
[0m04:47:14.203565 [info ] [Thread-1 (]: 2 of 2 START sql view model analytics.mart_sales_summary ....................... [RUN]
[0m04:47:14.204662 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ecommerce_dbt.stg_sales, now model.ecommerce_dbt.mart_sales_summary)
[0m04:47:14.205552 [debug] [Thread-1 (]: Began compiling node model.ecommerce_dbt.mart_sales_summary
[0m04:47:14.208331 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_dbt.mart_sales_summary"
[0m04:47:14.238449 [debug] [Thread-1 (]: Began executing node model.ecommerce_dbt.mart_sales_summary
[0m04:47:14.244173 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_dbt.mart_sales_summary"
[0m04:47:14.267903 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_dbt.mart_sales_summary"
[0m04:47:14.268962 [debug] [Thread-1 (]: On model.ecommerce_dbt.mart_sales_summary: BEGIN
[0m04:47:14.269996 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:47:14.277941 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m04:47:14.279834 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_dbt.mart_sales_summary"
[0m04:47:14.281311 [debug] [Thread-1 (]: On model.ecommerce_dbt.mart_sales_summary: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "ecommerce_profile", "target_name": "dev", "node_id": "model.ecommerce_dbt.mart_sales_summary"} */

  create view "ecommerce"."analytics"."mart_sales_summary__dbt_tmp"
    
    
  as (
    with sales as (
  select order_date, quantity, price, quantity * price as sales_amount
  from "ecommerce"."analytics"."stg_sales"
)
select
  order_date,
  sum(quantity) as total_items,
  sum(sales_amount) as total_revenue
from sales
group by order_date
order by order_date
  );
[0m04:47:14.284523 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m04:47:14.293065 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_dbt.mart_sales_summary"
[0m04:47:14.294353 [debug] [Thread-1 (]: On model.ecommerce_dbt.mart_sales_summary: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "ecommerce_profile", "target_name": "dev", "node_id": "model.ecommerce_dbt.mart_sales_summary"} */
alter table "ecommerce"."analytics"."mart_sales_summary__dbt_tmp" rename to "mart_sales_summary"
[0m04:47:14.295814 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m04:47:14.297653 [debug] [Thread-1 (]: On model.ecommerce_dbt.mart_sales_summary: COMMIT
[0m04:47:14.298628 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_dbt.mart_sales_summary"
[0m04:47:14.299452 [debug] [Thread-1 (]: On model.ecommerce_dbt.mart_sales_summary: COMMIT
[0m04:47:14.302210 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m04:47:14.304648 [debug] [Thread-1 (]: Applying DROP to: "ecommerce"."analytics"."mart_sales_summary__dbt_backup"
[0m04:47:14.306206 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_dbt.mart_sales_summary"
[0m04:47:14.307139 [debug] [Thread-1 (]: On model.ecommerce_dbt.mart_sales_summary: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "ecommerce_profile", "target_name": "dev", "node_id": "model.ecommerce_dbt.mart_sales_summary"} */
drop view if exists "ecommerce"."analytics"."mart_sales_summary__dbt_backup" cascade
[0m04:47:14.308245 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m04:47:14.309886 [debug] [Thread-1 (]: On model.ecommerce_dbt.mart_sales_summary: Close
[0m04:47:14.311030 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fa829b4c-cd22-450a-a88a-9880864f057e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73b14b2bb2d0>]}
[0m04:47:14.312128 [info ] [Thread-1 (]: 2 of 2 OK created sql view model analytics.mart_sales_summary .................. [[32mCREATE VIEW[0m in 0.11s]
[0m04:47:14.313558 [debug] [Thread-1 (]: Finished running node model.ecommerce_dbt.mart_sales_summary
[0m04:47:14.315923 [debug] [MainThread]: Using postgres connection "master"
[0m04:47:14.316837 [debug] [MainThread]: On master: BEGIN
[0m04:47:14.317581 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m04:47:14.323693 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m04:47:14.325130 [debug] [MainThread]: On master: COMMIT
[0m04:47:14.326810 [debug] [MainThread]: Using postgres connection "master"
[0m04:47:14.327713 [debug] [MainThread]: On master: COMMIT
[0m04:47:14.329083 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m04:47:14.330207 [debug] [MainThread]: On master: Close
[0m04:47:14.331425 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:47:14.336384 [debug] [MainThread]: Connection 'model.ecommerce_dbt.mart_sales_summary' was properly closed.
[0m04:47:14.338547 [info ] [MainThread]: 
[0m04:47:14.343983 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 0.59 seconds (0.59s).
[0m04:47:14.346452 [debug] [MainThread]: Command end result
[0m04:47:14.386533 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m04:47:14.398536 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m04:47:14.415166 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt/target/run_results.json
[0m04:47:14.416438 [info ] [MainThread]: 
[0m04:47:14.417766 [info ] [MainThread]: [32mCompleted successfully[0m
[0m04:47:14.419153 [info ] [MainThread]: 
[0m04:47:14.420400 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m04:47:14.422225 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.4159, "process_in_blocks": "0", "process_kernel_time": 0.229024, "process_mem_max_rss": "119516", "process_out_blocks": "0", "process_user_time": 2.065242}
[0m04:47:14.426838 [debug] [MainThread]: Command `dbt run` succeeded at 04:47:14.426519 after 1.42 seconds
[0m04:47:14.428214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73b14daef850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73b14daee550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73b151a251d0>]}
[0m04:47:14.429354 [debug] [MainThread]: Flushing usage events
[0m04:47:15.655473 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m04:47:17.600702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7de49c4ee250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7de49c511790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7de49e0334d0>]}


============================== 04:47:17.606050 | 7649d336-1844-473f-b141-98c1e2997a0d ==============================
[0m04:47:17.606050 [info ] [MainThread]: Running with dbt=1.10.13
[0m04:47:17.607657 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'debug': 'False', 'write_json': 'True', 'fail_fast': 'False', 'empty': 'None', 'introspect': 'True', 'profiles_dir': '.', 'static_parser': 'True', 'partial_parse': 'True', 'printer_width': '80', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'log_format': 'default', 'use_colors': 'True', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_cache_events': 'False', 'invocation_command': 'dbt test --profiles-dir .', 'warn_error': 'None', 'no_print': 'None', 'log_path': '/opt/airflow/dbt/logs', 'quiet': 'False', 'use_experimental_parser': 'False'}
[0m04:47:17.759890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7649d336-1844-473f-b141-98c1e2997a0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7de49c343a10>]}
[0m04:47:17.803928 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7649d336-1844-473f-b141-98c1e2997a0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7de49f024a10>]}
[0m04:47:17.805913 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m04:47:17.887622 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m04:47:18.076141 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m04:47:18.077155 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m04:47:18.104085 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7649d336-1844-473f-b141-98c1e2997a0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7de49a9b2590>]}
[0m04:47:18.181854 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m04:47:18.214404 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m04:47:18.261255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7649d336-1844-473f-b141-98c1e2997a0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7de49a7a89d0>]}
[0m04:47:18.264438 [info ] [MainThread]: Found 2 models, 1 seed, 447 macros
[0m04:47:18.266335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7649d336-1844-473f-b141-98c1e2997a0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7de49abbf690>]}
[0m04:47:18.268857 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m04:47:18.273089 [debug] [MainThread]: Command end result
[0m04:47:18.315797 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m04:47:18.328881 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m04:47:18.342370 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt/target/run_results.json
[0m04:47:18.345313 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.8062944, "process_in_blocks": "1224", "process_kernel_time": 0.228176, "process_mem_max_rss": "113552", "process_out_blocks": "0", "process_user_time": 1.897467}
[0m04:47:18.347439 [debug] [MainThread]: Command `dbt test` succeeded at 04:47:18.347300 after 0.81 seconds
[0m04:47:18.349227 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7de49c6dbc90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7de49c511450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7de4a0441350>]}
[0m04:47:18.350333 [debug] [MainThread]: Flushing usage events
[0m04:47:19.460806 [debug] [MainThread]: An error was encountered while trying to flush usage events
